import{d as K,g as U,_ as F}from"./index.a4d7697a.js";import{P as H,Y as M,d as N,k as O,U as V,_ as L}from"./@arco-design.95e0b031.js";import"./vue.24dcbee8.js";import{u as j}from"./loading.0f5749b3.js";import{e as S,a as h,u as x,b as _,h as g,g as G}from"./serial.d615852e.js";import{I as W,B as Y,T as q}from"./tdesign-vue-next.62a9d0ce.js";import{G as J}from"./tdesign-icons-vue-next.514651cc.js";import{d as Q,h as y,c as X,o as Z,a as tt,x as s,u as i,e as P,A as m,z as w,_ as v}from"./@vue.2faf1d8e.js";import{v as et}from"./vue-i18n.4b9acc8b.js";import"./vue-echarts.29561399.js";import"./resize-detector.a8854a64.js";import"./echarts.5b0e6023.js";import"./zrender.ce26131e.js";import"./tslib.c6ba9914.js";import"./vue-router.425aabc5.js";import"./nprogress.77f16b3e.js";import"./@intlify.b8ed1d74.js";import"./mitt.550594b0.js";import"./pinia.510425a1.js";import"./vue-demi.1e0b7689.js";import"./axios.234ce069.js";import"./@vueuse.c5c16882.js";import"./aegis-web-sdk.088ecaea.js";import"./@zxing.8654f0db.js";import"./vue-matomo.ed94ba67.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.08dc07e5.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./sortablejs.b2e3c7c4.js";import"./@popperjs.f3f73334.js";const at={class:"container"},ot={name:"Radio"},rt=Q({...ot,setup(nt){const{t:D}=et.exports.useI18n(),o=K(),{loading:b,setLoading:u}=j(!1),a=y({renderData:Array.from({length:20}).map(e=>({})),pageSize:50,nowPage:1}),C=y({showHide:0}),I=e=>{a.renderData=e.newData},z=X(()=>[{colKey:"drag",title:D("cps.sort"),width:46},{title:"#",colKey:"index",align:"left",width:100},{title:D("cps.rx"),colKey:"rx",align:"left",width:200,cell:(e,{row:r})=>parseFloat(r.rx)?parseFloat(r.rx).toFixed(2):void 0,edit:{component:W,props:{clearable:!0},onEdited:e=>{e.newRowData.rx=e.newRowData.rx?e.newRowData.rx:void 0;const r=[...a.renderData];r.splice((a.nowPage-1)*a.pageSize+e.rowIndex,1,e.newRowData),a.renderData=r}}},{title:D("cps.operate"),colKey:"operate",align:"left",width:150}]),R=async()=>{var e,r,l;if(o.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if(await S(o.connectPort),u(!0),(e=o.configuration)!=null&&e.fm30){let c=new Uint8Array(60);for(let t=131008;t<131057;t+=8){const p=await h(o.connectPort,t,8,(r=o.configuration)==null?void 0:r.uart);c.set(p,t-131008)}const n=[];for(let t=0;t<60;t+=2){const p=x(c.subarray(t,t+2));p!="ffff"?n.push({rx:parseInt(p,16)/10}):n.push({})}a.renderData=n}else{let c=new Uint8Array(40);for(let t=3648;t<3681;t+=8){const p=await h(o.connectPort,t,8,(l=o.configuration)==null?void 0:l.uart);c.set(p,t-3648)}const n=[];for(let t=0;t<40;t+=2){const p=x(c.subarray(t,t+2));p!="ffff"?n.push({rx:parseInt(p,16)/10}):n.push({})}a.renderData=n}u(!1)},$=async()=>{var e,r,l,c,n;if(o.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if(await S(o.connectPort),u(!0),(e=o.configuration)!=null&&e.fm30)for(let t=0;t<60;t+=2)a.renderData[t/2].rx?await _(o.connectPort,t+131008,g(parseInt(a.renderData[t/2].rx*10).toString(16).padStart(4,"0")),2,(r=o.configuration)==null?void 0:r.uart):await _(o.connectPort,t+131008,g("0000"),2,(l=o.configuration)==null?void 0:l.uart);else for(let t=0;t<40;t+=2)a.renderData[t/2].rx?await _(o.connectPort,t+3648,g(parseInt(a.renderData[t/2].rx*10).toString(16).padStart(4,"0")),2,(c=o.configuration)==null?void 0:c.uart):await _(o.connectPort,t+3648,g("0000"),2,(n=o.configuration)==null?void 0:n.uart);await G(o.connectPort),u(!1)},k=async e=>{const r=[...a.renderData];r.splice(e,1,{scanlist:[]}),a.renderData=r};return(e,r)=>{const l=U,c=M,n=N,t=O,p=V,A=L,B=Y,T=q,E=H;return Z(),tt("div",at,[s(l,{items:[e.$t("menu.dashboard"),e.$t("menu.cps.radio")]},null,8,["items"]),s(E,{class:"general-card"},{title:i(()=>[P("span",{onClick:r[0]||(r[0]=()=>{C.showHide+=1})},m(e.$t("menu.cps.radio")+e.$t("global.onStart")),1)]),default:i(()=>[s(A,{style:{"margin-bottom":"16px"}},{default:i(()=>[s(p,{span:12},{default:i(()=>[s(t,null,{default:i(()=>[s(n,{type:"primary",onClick:R},{icon:i(()=>[s(c)]),default:i(()=>[w(" "+m(e.$t("cps.onDeviceRead")),1)]),_:1}),s(n,{onClick:$},{icon:i(()=>[s(c)]),default:i(()=>[w(" "+m(e.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(T,{class:"ttable",loading:v(b),size:"medium",columns:z.value,data:a.renderData,pagination:{defaultPageSize:a.pageSize,total:a.renderData.length,defaultCurrent:1,pageSizeOptions:[15,30,50,100,200]},onChange:r[1]||(r[1]=d=>{a.pageSize=d.pagination.pageSize,a.nowPage=d.pagination.current}),bordered:"","lazy-load":"",headerAffixedTop:{offsetTop:60},hover:!0,"drag-sort":"row-handler",onDragSort:I},{drag:i(({row:d,rowIndex:f})=>[P("span",null,[s(v(J))])]),index:i(({row:d,rowIndex:f})=>[w(m((a.nowPage-1)*a.pageSize+f+1),1)]),operate:i(({row:d,rowIndex:f})=>[s(B,{theme:"default",variant:"dashed",onClick:it=>k((a.nowPage-1)*a.pageSize+f)},{default:i(()=>[w(m(e.$t("cps.clear")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","columns","data","pagination"])]),_:1})])}}});const Nt=F(rt,[["__scopeId","data-v-be263a43"]]);export{Nt as default};
