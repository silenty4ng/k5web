import{g as O,_ as P}from"./index.09b560e5.js";import{a6 as R,a2 as T,P as j,a7 as G,d as H,U as V,_ as $}from"./@arco-design.10d71e42.js";import"./vue.ffb667bf.js";import{b as B}from"./vue-router.a9f5d186.js";import{u as z}from"./loading.566f8821.js";import{m as M}from"./marked.1f6edc11.js";import{p as A}from"./dompurify.67eb19fb.js";import{L as F,S as I}from"./tdesign-vue-next.ed813ef2.js";import{d as Y,h as q,w as Q,l as K,o as p,a as w,x as r,u as s,_ as W,b as E,z as m,A as h,F as S,Q as L,s as D}from"./@vue.6ceb3fa6.js";import{v as X}from"./vue-i18n.5fb6db72.js";import"./nprogress.6328d444.js";import"./@intlify.02b6985d.js";import"./mitt.550594b0.js";import"./pinia.fa8b6be2.js";import"./vue-demi.0e7683c7.js";import"./axios.06033baf.js";import"./@vueuse.a7db99fe.js";import"./@zxing.8654f0db.js";import"./@microsoft.d2aaf3b7.js";import"./vue-matomo.5bdfe9a5.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.35d19ede.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./lodash-es.18922ecc.js";import"./sortablejs.77296005.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";const Z={class:"container"},ee={name:"DIY"},te=Y({...ee,setup(ae){const U=B(),{t:v}=X.exports.useI18n(),C=()=>{U.push({path:"/tool/flash",query:{url:"https://k5.vicicode.cn/diyapi/LOSEHU"+e.flag.join("")+".bin?v="+new Date().getTime()}})},J=()=>{fetch("https://k5.vicicode.cn/diyapi/LOSEHU"+e.flag.join("")+".bin?v="+new Date().getTime()).then(t=>t.blob()).then(t=>{const o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download="LOSEHU-CUSTOM-"+e.flag.join("")+".bin",document.body.appendChild(i),i.click(),document.body.removeChild(i)})},e=q({versions:[],flag:[],disMatrix:[],disName:[],showSort:[],readme:""});Q(()=>[...e.flag],()=>{b()});const b=()=>{e.flag.map((t,o)=>{e.disMatrix[o].forEach((i,l)=>{e.versions.indexOf("LOSEHU"+e.flag.join("").substring(0,o)+l+e.flag.join("").substring(o+1)+".bin")==-1?e.disMatrix[o].set(l,!0):e.disMatrix[o].set(l,!1)})})},{loading:N,setLoading:k}=z(!0);return K(async()=>{k(!0);let t=await(await fetch("https://k5.vicicode.cn/diyapi/function.json?v="+new Date().getTime())).text();t=JSON.parse(t);let o=[],i=[];t.map(a=>{o[a[a.length-1]-1]=a,i.push(a[a.length-1]-1)}),t=o;let l=[],u=[];t.map(a=>{let f=new Map,d=new Map;for(let n=a[0]*2+1;n<a[0]*3+1;n++)f.set(a[n],!1),v("idea.diy")!=="LOSEHU DIY"?d.set(a[n],a[n-a[0]-a[0]]):d.set(a[n],a[n-a[0]]);l.push(f),u.push(d)}),e.flag=new Array(t.length).fill("0"),e.disName=u,e.disMatrix=l,e.showSort=i;const g=await(await fetch("https://k5.vicicode.cn/diyapi/version.json?v="+new Date().getTime())).text();e.versions=JSON.parse(g),b(),k(!1),v("menu.dashboard")=="CPS"?e.readme=A.sanitize(await M.parse(await(await fetch("https://k5.vicicode.cn/diyapi/README_en.md?v="+new Date().getTime())).text())):e.readme=A.sanitize(await M.parse(await(await fetch("https://k5.vicicode.cn/diyapi/README.md?v="+new Date().getTime())).text())),e.readme=e.readme.replaceAll('href="./README_en.md"',""),e.readme=e.readme.replaceAll('href="./README.md"',""),e.readme=e.readme.replaceAll("losehu/uv-k5-firmware-chinese/blob/main/payment/show.png","losehu/uv-k5-firmware-chinese/blob/main/payment/show.png?raw=true"),e.readme=e.readme.replaceAll("/images/c1.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c1.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c2.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c2.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c3.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c3.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c4.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c4.JPG?raw=true"),e.readme=e.readme.replaceAll("a href",'a target="_blank" href')}),(t,o)=>{const i=O,l=F,u=R,g=G,a=H,f=T,d=I,n=j,y=V,x=$;return p(),w("div",Z,[r(i,{items:[t.$t("menu.workshop"),t.$t("idea.diy")]},null,8,["items"]),r(x,{gutter:20,align:"stretch"},{default:s(()=>[r(y,{span:24},{default:s(()=>[r(n,{class:"general-card",title:t.$t("idea.diy"),loading:W(N)},{default:s(()=>[r(d,{direction:"vertical"},{default:s(()=>[E("div",null,[m(h(t.$t("oi")),1),r(l,{theme:"primary",href:"https://github.com/losehu/uv-k5-firmware-custom",target:"_blank"},{default:s(()=>[...o[0]||(o[0]=[m("https://github.com/losehu/uv-k5-firmware-custom",-1)])]),_:1})]),(p(!0),w(S,null,L(e.showSort,_=>(p(),D(g,{modelValue:e.flag[_],"onUpdate:modelValue":c=>e.flag[_]=c,type:"button"},{default:s(()=>[(p(!0),w(S,null,L(e.disMatrix[_],c=>(p(),D(u,{value:c[0],disabled:c[1]},{default:s(()=>[m(h(e.disName[_].get(c[0])),1)]),_:2},1032,["value","disabled"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]))),256)),E("div",null,[r(a,{type:"primary",onClick:C},{default:s(()=>[m(h(t.$t("diy.generate")),1)]),_:1}),o[1]||(o[1]=m("\xA0\xA0 ",-1)),r(f,{onClick:J},{default:s(()=>[m(h(t.$t("global.download")),1)]),_:1})])]),_:1})]),_:1},8,["title","loading"])]),_:1})]),_:1}),r(x,{gutter:20,align:"stretch",style:{"margin-top":"10px"}},{default:s(()=>[r(y,{span:24},{default:s(()=>[r(n,{style:{padding:"20px"},class:"general-card readme",innerHTML:e.readme},null,8,["innerHTML"])]),_:1})]),_:1})])}}});const Oe=P(te,[["__scopeId","data-v-2c3f2359"]]);export{Oe as default};
