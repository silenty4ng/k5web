import{d as Ee,g as Fe,_ as Pe}from"./index.a4e793ee.js";import{P as Re,f as Ke,Y as Be,d as Ae,k as Ne,U as Ue,Z as ze,m as Me,_ as je}from"./@arco-design.2114ce1c.js";import"./vue.ffb667bf.js";import{u as Ve}from"./vue-router.a9f5d186.js";import{u as $e}from"./loading.566f8821.js";import{e as fe,b as re,u as Se,f as Le,h as oe,s as He,g as ie,i as Je,d as Qe}from"./serial.c484fd9f.js";import{c as Ge}from"./chinese-s2t.a9ab083b.js";import{r as se,w as We}from"./xlsx.fbaab35d.js";import{I as de,c as R,M as qe,d as Xe,f as Ye,g as Ze,B as ke,T as et}from"./tdesign-vue-next.ed813ef2.js";import{M as tt}from"./tdesign-icons-vue-next.a5366875.js";import{d as at,r as nt,h as ue,a9 as rt,l as ot,c as it,o as pe,a as st,s as we,u as h,z as K,A as B,v as he,x as m,b as ne,_ as me}from"./@vue.6ceb3fa6.js";import{v as dt}from"./vue-i18n.5fb6db72.js";import"./nprogress.6328d444.js";import"./@intlify.02b6985d.js";import"./mitt.550594b0.js";import"./pinia.fa8b6be2.js";import"./vue-demi.0e7683c7.js";import"./axios.06033baf.js";import"./@vueuse.a7db99fe.js";import"./@zxing.8654f0db.js";import"./@microsoft.d2aaf3b7.js";import"./vue-matomo.5bdfe9a5.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.35d19ede.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./lodash-es.18922ecc.js";import"./sortablejs.77296005.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";const pt={class:"container"},lt={name:"Channel"},ct=at({...lt,setup(ft){const{t:S}=dt.exports.useI18n(),g=Ee(),{loading:De,setLoading:ae}=$e(!1),A=nt(0),s={bandwidthOption:{0:"25KHz",1:"12.5KHz"},modeOption:{0:"FM",1:"AM",2:"USB"},powerOptionEng:{0:"Low",1:"Med",2:"High"},powerOption:{0:"\u4F4E",1:"\u4E2D",2:"\u9AD8"},toneOptionEng:{1:"Tone",2:"DTCS(N)",3:"DTCS(I)"},toneOption:{1:"\u4E9A\u97F3\u9891",2:"\u6570\u5B57\u4E9A\u97F3",3:"\u53CD\u5411\u6570\u5B57\u4E9A\u97F3"},CTCSSOption:[67,69.3,71.9,74.4,77,79.7,82.5,85.4,88.5,91.5,94.8,97.4,100,103.5,107.2,110.9,114.8,118.8,123,127.3,131.8,136.5,141.3,146.2,151.4,156.7,159.8,162.2,165.5,167.9,171.3,173.8,177.3,179.9,183.5,186.2,189.9,192.8,196.6,199.5,203.5,206.5,210.7,218.1,225.7,229.1,233.6,241.8,250.3,254.1],DCSOption:[23,25,26,31,32,36,43,47,51,53,54,65,71,72,73,74,114,115,116,122,125,131,132,134,143,145,152,155,156,162,165,172,174,205,212,223,225,226,243,244,245,246,251,252,255,261,263,265,266,271,274,306,311,315,325,331,332,343,346,351,356,364,365,371,411,412,413,423,431,432,445,446,452,454,455,462,464,465,466,503,506,516,523,526,532,546,565,606,612,624,627,631,632,654,662,664,703,712,723,731,732,734,743,754],stepOption:[2.5,5,6.25,10,12.5,25,8.33,.01,.05,.1,.25,.5,1,1.25,9,15,20,30,50,100,125,200,250,500],scrambOption:["1","2","3","4","5","6","7","8","9","10"],pttidOptionEng:["UP CODE","DOWW CODE","UP+DOWN Code","APOLLO QUINDAR"],pttidOption:["\u4E0A\u7EBF\u7801","\u4E0B\u7EBF\u7801","\u4E0A\u7EBF+\u4E0B\u7EBF\u7801","Quindar\u7801"]},t=ue({renderData:Array.from({length:200}).map(e=>({scanlist:[]})),pageSize:15,nowPage:1}),te=ue({showHide:0,showNotice:!1}),xe=e=>{t.renderData=e.newData},le=Ve();rt(()=>{S("menu.dashboard")=="CPS"&&(s.powerOption=s.powerOptionEng,s.toneOption=s.toneOptionEng,s.pttidOption=s.pttidOptionEng)}),ot(async()=>{var a,o,x,f,v,p,b,r,c,C,l,u,T,I,F,_,P,w,O,y,U,z,M,j,V,$,L,H,J,Q,G,W,q,X,Y;if(le.query.url){const N=await fetch(le.query.url),Z=(a=N==null?void 0:N.body)==null?void 0:a.getReader();if(Z){const k=[];for(;;){const{done:d,value:i}=await Z.read();if(d)break;k.push(...i)}const ee=new Uint8Array(k);var e=se(ee);const D=Array.from({length:200}).map(d=>({scanlist:[]}));for(let d=2;d<202;d++)(o=e.Sheets.Sheet1["B"+d])!=null&&o.w&&(D[d-2].name=(x=e.Sheets.Sheet1["B"+d])==null?void 0:x.w),(f=e.Sheets.Sheet1["C"+d])!=null&&f.w&&(D[d-2].bandwidth=Object.keys(s.bandwidthOption).find(i=>{var n;return s.bandwidthOption[i]==((n=e.Sheets.Sheet1["C"+d])==null?void 0:n.w)})),(v=e.Sheets.Sheet1["D"+d])!=null&&v.w&&(D[d-2].rx=(p=e.Sheets.Sheet1["D"+d])==null?void 0:p.w),(b=e.Sheets.Sheet1["E"+d])!=null&&b.w&&(D[d-2].tx=(r=e.Sheets.Sheet1["E"+d])==null?void 0:r.w),(c=e.Sheets.Sheet1["F"+d])!=null&&c.w&&(D[d-2].power=Object.keys(s.powerOption).find(i=>{var n;return s.powerOption[i]==((n=e.Sheets.Sheet1["F"+d])==null?void 0:n.w)})),(C=e.Sheets.Sheet1["G"+d])!=null&&C.w&&(D[d-2].rxTone=Object.keys(s.toneOption).find(i=>{var n;return s.toneOption[i]==((n=e.Sheets.Sheet1["G"+d])==null?void 0:n.w)})),(l=e.Sheets.Sheet1["H"+d])!=null&&l.w&&(D[d-2].rxCTCSS=parseFloat((u=e.Sheets.Sheet1["H"+d])==null?void 0:u.w)),(T=e.Sheets.Sheet1["I"+d])!=null&&T.w&&(D[d-2].rxDCS=parseFloat((I=e.Sheets.Sheet1["I"+d])==null?void 0:I.w)),(F=e.Sheets.Sheet1["J"+d])!=null&&F.w&&(D[d-2].txTone=Object.keys(s.toneOption).find(i=>{var n;return s.toneOption[i]==((n=e.Sheets.Sheet1["J"+d])==null?void 0:n.w)})),(_=e.Sheets.Sheet1["K"+d])!=null&&_.w&&(D[d-2].txCTCSS=parseFloat((P=e.Sheets.Sheet1["K"+d])==null?void 0:P.w)),(w=e.Sheets.Sheet1["L"+d])!=null&&w.w&&(D[d-2].txDCS=parseFloat((O=e.Sheets.Sheet1["L"+d])==null?void 0:O.w)),(y=e.Sheets.Sheet1["M"+d])!=null&&y.w&&(D[d-2].step=parseFloat((U=e.Sheets.Sheet1["M"+d])==null?void 0:U.w)),(z=e.Sheets.Sheet1["N"+d])!=null&&z.w&&(D[d-2].reverse=((M=e.Sheets.Sheet1["N"+d])==null?void 0:M.w)==S("On")),(j=e.Sheets.Sheet1["O"+d])!=null&&j.w&&(D[d-2].scramb=parseFloat((V=e.Sheets.Sheet1["O"+d])==null?void 0:V.w)),($=e.Sheets.Sheet1["P"+d])!=null&&$.w&&(D[d-2].busy=((L=e.Sheets.Sheet1["P"+d])==null?void 0:L.w)==S("On")),(H=e.Sheets.Sheet1["Q"+d])!=null&&H.w&&(D[d-2].pttid=(J=e.Sheets.Sheet1["Q"+d])==null?void 0:J.w),(Q=e.Sheets.Sheet1["R"+d])!=null&&Q.w&&(D[d-2].mode=Object.keys(s.modeOption).find(i=>{var n;return s.modeOption[i]==((n=e.Sheets.Sheet1["R"+d])==null?void 0:n.w)})),(G=e.Sheets.Sheet1["S"+d])!=null&&G.w&&(D[d-2].dtmf=((W=e.Sheets.Sheet1["S"+d])==null?void 0:W.w)==S("On")),(q=e.Sheets.Sheet1["T"+d])!=null&&q.w&&(((X=e.Sheets.Sheet1["T"+d])==null?void 0:X.w.split(",").indexOf("I"))>=0&&D[d-2].scanlist.push("I"),((Y=e.Sheets.Sheet1["T"+d])==null?void 0:Y.w.split(",").indexOf("II"))>=0&&D[d-2].scanlist.push("II"));t.renderData=D}}});const ge=it(()=>[{colKey:"drag",title:S("cps.sort"),width:46},{title:"#",colKey:"index",align:"left",width:100},{title:S("cps.name"),colKey:"name",width:250,align:"left",edit:{component:de,props:{clearable:!0},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.bandwidth"),colKey:"bandwidth",align:"left",width:150,cell:(e,{row:a})=>{var o;return(o=s.bandwidthOption[a.bandwidth])!=null?o:""},edit:{component:R,props:{clearable:!0,options:Object.keys(s.bandwidthOption).map(e=>({value:e,label:s.bandwidthOption[e]}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.rx"),colKey:"rx",align:"left",width:200,cell:(e,{row:a})=>parseFloat(a.rx)?parseFloat(a.rx).toFixed(5):void 0,edit:{component:de,props:{clearable:!0},onEdited:e=>{e.newRowData.rx=e.newRowData.rx?e.newRowData.rx:void 0;const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.tx"),colKey:"tx",align:"left",width:200,cell:(e,{row:a})=>parseFloat(a.tx)?parseFloat(a.tx).toFixed(5):void 0,edit:{component:de,props:{clearable:!0},onEdited:e=>{e.newRowData.tx=e.newRowData.tx?e.newRowData.tx:void 0;const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.power"),colKey:"power",align:"left",width:150,cell:(e,{row:a})=>{var o;return(o=s.powerOption[a.power])!=null?o:""},edit:{component:R,props:{clearable:!0,options:Object.keys(s.powerOption).map(e=>({value:e,label:s.powerOption[e]}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.rxToneType"),colKey:"rxTone",align:"left",width:180,cell:(e,{row:a})=>{var o;return(o=s.toneOption[a.rxTone])!=null?o:""},edit:{component:R,props:{clearable:!0,options:Object.keys(s.toneOption).map(e=>({value:e,label:s.toneOption[e]}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.rxToneCTCSS"),colKey:"rxCTCSS",align:"left",width:150,cell:(e,{row:a})=>{var o;return s.CTCSSOption.indexOf(a.rxCTCSS)>=0?(o=a.rxCTCSS)==null?void 0:o.toFixed(1):void 0},edit:{component:R,props:{clearable:!0,options:s.CTCSSOption.map(e=>({value:e,label:e.toFixed(1)}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.rxToneDCS"),colKey:"rxDCS",align:"left",width:150,cell:(e,{row:a})=>s.DCSOption.indexOf(a.rxDCS)>=0?"0"+a.rxDCS:void 0,edit:{component:R,props:{clearable:!0,options:s.DCSOption.map(e=>({value:e,label:"0"+e}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.txToneType"),colKey:"txTone",align:"left",width:180,cell:(e,{row:a})=>{var o;return(o=s.toneOption[a.txTone])!=null?o:""},edit:{component:R,props:{clearable:!0,options:Object.keys(s.toneOption).map(e=>({value:e,label:s.toneOption[e]}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.txToneCTCSS"),colKey:"txCTCSS",align:"left",width:150,cell:(e,{row:a})=>{var o;return s.CTCSSOption.indexOf(a.txCTCSS)>=0?(o=a.txCTCSS)==null?void 0:o.toFixed(1):void 0},edit:{component:R,props:{clearable:!0,options:s.CTCSSOption.map(e=>({value:e,label:e.toFixed(1)}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.txToneDCS"),colKey:"txDCS",align:"left",width:150,cell:(e,{row:a})=>s.DCSOption.indexOf(a.txDCS)>=0?"0"+a.txDCS:void 0,edit:{component:R,props:{clearable:!0,options:s.DCSOption.map(e=>({value:e,label:"0"+e}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.step"),colKey:"step",align:"left",width:150,cell:(e,{row:a})=>{var o;return s.stepOption.indexOf(a.step)>=0?(o=a.step)==null?void 0:o.toFixed(2):void 0},edit:{component:R,props:{clearable:!0,options:s.stepOption.map(e=>({value:e,label:e.toFixed(2)}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.reverse"),colKey:"reverse",align:"left",width:150},{title:S("cps.scramb"),colKey:"scramb",align:"left",width:150,edit:{component:R,props:{clearable:!0,options:s.scrambOption.map(e=>({value:e,label:e}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.busy"),colKey:"busy",align:"left",width:150},{title:S("cps.pttid"),colKey:"pttid",align:"left",width:150,edit:{component:R,props:{clearable:!0,options:s.pttidOption.map(e=>({value:e,label:e}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.mode"),colKey:"mode",align:"left",width:150,cell:(e,{row:a})=>{var o;return(o=s.modeOption[a.mode])!=null?o:""},edit:{component:R,props:{clearable:!0,options:Object.keys(s.modeOption).map(e=>({value:e,label:s.modeOption[e]}))},onEdited:e=>{const a=[...t.renderData];a.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=a}}},{title:S("cps.dtmf"),colKey:"dtmf",align:"left",width:150},{title:S("cps.scanlist"),colKey:"scanlist",align:"left",width:150},{title:S("cps.operate"),colKey:"operate",align:"left",width:150}]),ce=[50,108,136,174,350,400,470],Oe=async()=>{var f,v,p,b;if(g.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await fe(g.connectPort),ae(!0),A.value=0;let e=new Uint8Array(3200);for(let r=0;r<3200;r+=64){A.value+=1;const c=await re(g.connectPort,r,64,(f=g.configuration)==null?void 0:f.uart);e.set(c,r)}let a=new Uint8Array(192);for(let r=3424;r<3616;r+=64){const c=await re(g.connectPort,r,64,(v=g.configuration)==null?void 0:v.uart);a.set(c,r-3424)}let o=new Uint8Array(3200);for(let r=3920;r<7120;r+=64){A.value+=1;const c=await re(g.connectPort,r,64,(p=g.configuration)==null?void 0:p.uart);o.set(c,r-3920)}const x=[];for(let r=0;r<3200;r+=16){const c=Se(e.subarray(r,r+16)),C=Se(a.subarray(r/16,r/16+1)),l={scanlist:[]};l.rx=c.substr(24,8)!="ffffffff"?parseInt(c.substr(24,8),16)/1e5:void 0,l.rx&&C!="ff"&&C!="0f"?(console.info(c),console.info(C),l.offset=c.substr(16,8)!="00000000"?parseInt(c.substr(16,8),16)/1e5:void 0,l.txcodeflag=c.substr(9,1),l.txcodeflag=="1"&&(l.tx=l.rx+l.offset),l.txcodeflag=="2"&&(l.tx=l.rx-l.offset),l.txTone=parseInt(c.substr(10,1),16)>0?parseInt(c.substr(10,1),16).toString():void 0,l.rxTone=parseInt(c.substr(11,1),16)>0?parseInt(c.substr(11,1),16).toString():void 0,l.txTone=="1"&&(l.txCTCSS=s.CTCSSOption[parseInt(c.substr(12,2),16)]),(l.txTone=="2"||l.txTone=="3")&&(l.txDCS=s.DCSOption[parseInt(c.substr(12,2),16)]),l.rxTone=="1"&&(l.rxCTCSS=s.CTCSSOption[parseInt(c.substr(14,2),16)]),(l.rxTone=="2"||l.rxTone=="3")&&(l.rxDCS=s.DCSOption[parseInt(c.substr(14,2),16)]),l.step=s.stepOption[parseInt(c.substr(2,2),16)],l.scramb=parseInt(c.substr(0,2),16)>0?parseInt(c.substr(0,2),16).toString():void 0,l.power_reverse_busy_width=parseInt(c.substr(6,2),16),l.reverse=!!(l.power_reverse_busy_width>>0&1),l.bandwidth=(l.power_reverse_busy_width>>1&1).toString(),l.power=(l.power_reverse_busy_width>>2&3).toString(),l.busy=!!(l.power_reverse_busy_width>>4&1),l.pttid_dtmf=parseInt(c.substr(4,2),16),l.pttid=s.pttidOption[(l.pttid_dtmf>>1)-1],l.dtmf=!!(l.pttid_dtmf>>0&1),l.mode=parseInt(c.substr(8,1),16).toString(),l.name=Le(o.subarray(r,r+16),(b=g.configuration)==null?void 0:b.charset),parseInt(C.substr(0,1),16)&8&&l.scanlist.push("I"),parseInt(C.substr(0,1),16)&4&&l.scanlist.push("II")):l.rx=void 0,x.push(l)}t.renderData=x,ae(!1),A.value=0},Ce=async()=>{var f,v,p,b;if(g.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await fe(g.connectPort),ae(!0),A.value=0;let e=new Uint8Array(3200),a=new Uint8Array(200),o=new Uint8Array(3200),x=0;t.renderData.map(r=>{var c,C,l;if(r.rx){let u="";u+=parseInt(r.scramb)>0?parseInt(r.scramb).toString(16).padStart(2,"0"):"00",u+=s.stepOption.indexOf(r.step)>=0?s.stepOption.indexOf(r.step).toString(16).padStart(2,"0"):"00";let T=s.pttidOption.indexOf(r.pttid)+1<<1;T+=r.dtmf?1:0,u+=T.toString(16).padStart(2,"0");let I=r.busy?1<<4:0;switch(I+=r.power<<2,I+=r.bandwidth<<1,I+=r.reverse?1:0,u+=I.toString(16).padStart(2,"0"),u+=r.mode?r.mode.toString(16):"0",r.tx>0&&r.tx>r.rx?u+="1":r.tx>0&&r.tx<r.rx?u+="2":u+="0",u+=parseInt(r.txTone)>0?r.txTone.toString(16):"0",u+=parseInt(r.rxTone)>0?r.rxTone.toString(16):"0",r.txTone){case"1":u+=s.CTCSSOption.indexOf(r.txCTCSS).toString(16).padStart(2,"0");break;case"2":case"3":u+=s.DCSOption.indexOf(r.txDCS).toString(16).padStart(2,"0");break;default:u+="00"}switch(r.rxTone){case"1":u+=s.CTCSSOption.indexOf(r.rxCTCSS).toString(16).padStart(2,"0");break;case"2":case"3":u+=s.DCSOption.indexOf(r.rxDCS).toString(16).padStart(2,"0");break;default:u+="00"}const F=r.tx&&r.rx?Math.abs(parseInt((r.tx*1e5).toFixed(0))-parseInt((r.rx*1e5).toFixed(0))):NaN;u+=Number.isNaN(F)?"00000000":F.toString(16).padStart(8,"0"),u+=parseInt((r.rx*1e5).toFixed(0)).toString(16).padStart(8,"0"),u.indexOf("-1")!=-1&&(u=u.replace(/^(.{10})(.{6})(.*)$/,"$1000000$3")),console.log(u),e.set(oe(u),x);let _=0;((c=r.scanlist)==null?void 0:c.indexOf("I"))>=0&&(_+=8),((C=r.scanlist)==null?void 0:C.indexOf("II"))>=0&&(_+=4),a.set([(_<<4)+ce.indexOf(ce.reduce((w,O)=>O<r.rx?O:w))],x/16);const P=new Uint8Array(16);P.set(He(r.name?Ge.t2s(r.name):"",(l=g.configuration)==null?void 0:l.charset).subarray(0,16),0),o.set(P,x)}else e.set(oe("ffffffffffffffffffffffffffffffff"),x),a.set([255],x/16),o.set(oe("ffffffffffffffffffffffffffffffff"),x);x+=16});for(let r=0;r<3200;r+=64)A.value+=1,await ie(g.connectPort,r,e.slice(r,r+64),64,(f=g.configuration)==null?void 0:f.uart);await ie(g.connectPort,3424,a,200);for(let r=3920;r<7120;r+=64)A.value+=1,await ie(g.connectPort,r,o.slice(r-3920,r-3920+64),64,(v=g.configuration)==null?void 0:v.uart);await Je(g.connectPort),ae(!1),A.value=0,((p=g.configuration)==null?void 0:p.uart)=="official"&&((b=g.configuration)==null?void 0:b.charset)=="gb2312"&&(await Qe(g.connectPort),g.updateSettings({connectState:!1,connectPort:null,firmwareVersion:""}))},be=async e=>{const a=[...t.renderData];a.splice(e,1,{scanlist:[]}),t.renderData=a},ye=()=>{const e=JSON.stringify(t.renderData),a=new Blob([e],{type:"application/octet-stream"}),o=URL.createObjectURL(a),x=document.createElement("a");x.download="channel.json",x.href=o,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(o)},ve=()=>{const e=document.createElement("input");e.type="file",e.onchange=async()=>{const o=await new Blob([e.files[0]],{type:"application/octet-stream"}).text();t.renderData=JSON.parse(o)},e.click()},Ie=()=>{const e=document.createElement("a");e.href="/K5Channel.xlsx",S("menu.dashboard")=="CPS"&&(e.href="/K5Channel_EN.xlsx"),e.download="K5Channel.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},Te=async()=>{var v,p,b,r,c,C,l,u,T,I,F,_,P,w,O,y,U,z,M,j,V,$,L,H,J,Q,G,W,q,X,Y,N,Z,k,ee,D,d,i;let e;S("menu.dashboard")=="CPS"?e=await fetch("/K5Channel_EN.xlsx"):e=await fetch("/K5Channel.xlsx");const a=se(await e.arrayBuffer()),o=a.Sheets[a.SheetNames[0]];for(let n=2;n<202;n++)(v=t.renderData[n-2])!=null&&v.name&&(o["B"+n]={},o["B"+n].v=(p=t.renderData[n-2])==null?void 0:p.name),(b=t.renderData[n-2])!=null&&b.bandwidth&&(o["C"+n]={},o["C"+n].v=s.bandwidthOption[(r=t.renderData[n-2])==null?void 0:r.bandwidth]),(c=t.renderData[n-2])!=null&&c.rx&&(o["D"+n]={},o["D"+n].v=(C=t.renderData[n-2])==null?void 0:C.rx),(l=t.renderData[n-2])!=null&&l.tx&&(o["E"+n]={},o["E"+n].v=(u=t.renderData[n-2])==null?void 0:u.tx),(T=t.renderData[n-2])!=null&&T.power&&(o["F"+n]={},o["F"+n].v=s.powerOption[(I=t.renderData[n-2])==null?void 0:I.power]),(F=t.renderData[n-2])!=null&&F.rxTone&&(o["G"+n]={},o["G"+n].v=s.toneOption[(_=t.renderData[n-2])==null?void 0:_.rxTone]),(P=t.renderData[n-2])!=null&&P.rxCTCSS&&(o["H"+n]={},o["H"+n].v=(w=t.renderData[n-2])==null?void 0:w.rxCTCSS),(O=t.renderData[n-2])!=null&&O.rxDCS&&(o["I"+n]={},o["I"+n].v=(y=t.renderData[n-2])==null?void 0:y.rxDCS),(U=t.renderData[n-2])!=null&&U.txTone&&(o["J"+n]={},o["J"+n].v=s.toneOption[(z=t.renderData[n-2])==null?void 0:z.txTone]),(M=t.renderData[n-2])!=null&&M.txCTCSS&&(o["K"+n]={},o["K"+n].v=(j=t.renderData[n-2])==null?void 0:j.txCTCSS),(V=t.renderData[n-2])!=null&&V.txDCS&&(o["L"+n]={},o["L"+n].v=($=t.renderData[n-2])==null?void 0:$.txDCS),(L=t.renderData[n-2])!=null&&L.step&&(o["M"+n]={},o["M"+n].v=(H=t.renderData[n-2])==null?void 0:H.step),(J=t.renderData[n-2])!=null&&J.reverse&&(o["N"+n]={},o["N"+n].v=((Q=t.renderData[n-2])==null?void 0:Q.reverse)==!0?S("On"):S("Off")),(G=t.renderData[n-2])!=null&&G.scramb&&(o["O"+n]={},o["O"+n].v=(W=t.renderData[n-2])==null?void 0:W.scramb),(q=t.renderData[n-2])!=null&&q.busy&&(o["P"+n]={},o["P"+n].v=((X=t.renderData[n-2])==null?void 0:X.busy)==!0?S("On"):S("Off")),(Y=t.renderData[n-2])!=null&&Y.pttid&&(o["Q"+n]={},o["Q"+n].v=(N=t.renderData[n-2])==null?void 0:N.pttid),(Z=t.renderData[n-2])!=null&&Z.mode&&(o["R"+n]={},o["R"+n].v=s.modeOption[(k=t.renderData[n-2])==null?void 0:k.mode]),(ee=t.renderData[n-2])!=null&&ee.dtmf&&(o["S"+n]={},o["S"+n].v=((D=t.renderData[n-2])==null?void 0:D.dtmf)==!0?S("On"):S("Off")),(d=t.renderData[n-2])!=null&&d.scanlist&&(o["T"+n]={},o["T"+n].v=(i=t.renderData[n-2])==null?void 0:i.scanlist.join(","));const x=new Blob([We(a,{type:"buffer"})],{type:"application/octet-stream"}),f=document.createElement("a");f.href=URL.createObjectURL(x),f.download="K5Channel.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)},_e=()=>{const e=document.createElement("input");e.type="file",e.onchange=async()=>{const a=new Blob([e.files[0]],{type:"application/octet-stream"}),o=new FileReader;o.onload=function(x){var b,r,c,C,l,u,T,I,F,_,P,w,O,y,U,z,M,j,V,$,L,H,J,Q,G,W,q,X,Y,N,Z,k,ee,D,d;const f=Array.from({length:200}).map(i=>({scanlist:[]}));var v=(b=x.target)==null?void 0:b.result,p=se(v);for(let i=2;i<202;i++)(r=p.Sheets.Sheet1["B"+i])!=null&&r.w&&(f[i-2].name=(c=p.Sheets.Sheet1["B"+i])==null?void 0:c.w),(C=p.Sheets.Sheet1["C"+i])!=null&&C.w&&(f[i-2].bandwidth=Object.keys(s.bandwidthOption).find(n=>{var E;return s.bandwidthOption[n]==((E=p.Sheets.Sheet1["C"+i])==null?void 0:E.w)})),(l=p.Sheets.Sheet1["D"+i])!=null&&l.w&&(f[i-2].rx=(u=p.Sheets.Sheet1["D"+i])==null?void 0:u.w),(T=p.Sheets.Sheet1["E"+i])!=null&&T.w&&(f[i-2].tx=(I=p.Sheets.Sheet1["E"+i])==null?void 0:I.w),(F=p.Sheets.Sheet1["F"+i])!=null&&F.w&&(f[i-2].power=Object.keys(s.powerOption).find(n=>{var E;return s.powerOption[n]==((E=p.Sheets.Sheet1["F"+i])==null?void 0:E.w)})),(_=p.Sheets.Sheet1["G"+i])!=null&&_.w&&(f[i-2].rxTone=Object.keys(s.toneOption).find(n=>{var E;return s.toneOption[n]==((E=p.Sheets.Sheet1["G"+i])==null?void 0:E.w)})),(P=p.Sheets.Sheet1["H"+i])!=null&&P.w&&(f[i-2].rxCTCSS=parseFloat((w=p.Sheets.Sheet1["H"+i])==null?void 0:w.w)),(O=p.Sheets.Sheet1["I"+i])!=null&&O.w&&(f[i-2].rxDCS=parseFloat((y=p.Sheets.Sheet1["I"+i])==null?void 0:y.w)),(U=p.Sheets.Sheet1["J"+i])!=null&&U.w&&(f[i-2].txTone=Object.keys(s.toneOption).find(n=>{var E;return s.toneOption[n]==((E=p.Sheets.Sheet1["J"+i])==null?void 0:E.w)})),(z=p.Sheets.Sheet1["K"+i])!=null&&z.w&&(f[i-2].txCTCSS=parseFloat((M=p.Sheets.Sheet1["K"+i])==null?void 0:M.w)),(j=p.Sheets.Sheet1["L"+i])!=null&&j.w&&(f[i-2].txDCS=parseFloat((V=p.Sheets.Sheet1["L"+i])==null?void 0:V.w)),($=p.Sheets.Sheet1["M"+i])!=null&&$.w&&(f[i-2].step=parseFloat((L=p.Sheets.Sheet1["M"+i])==null?void 0:L.w)),(H=p.Sheets.Sheet1["N"+i])!=null&&H.w&&(f[i-2].reverse=((J=p.Sheets.Sheet1["N"+i])==null?void 0:J.w)==S("On")),(Q=p.Sheets.Sheet1["O"+i])!=null&&Q.w&&(f[i-2].scramb=parseFloat((G=p.Sheets.Sheet1["O"+i])==null?void 0:G.w)),(W=p.Sheets.Sheet1["P"+i])!=null&&W.w&&(f[i-2].busy=((q=p.Sheets.Sheet1["P"+i])==null?void 0:q.w)==S("On")),(X=p.Sheets.Sheet1["Q"+i])!=null&&X.w&&(f[i-2].pttid=(Y=p.Sheets.Sheet1["Q"+i])==null?void 0:Y.w),(N=p.Sheets.Sheet1["R"+i])!=null&&N.w&&(f[i-2].mode=Object.keys(s.modeOption).find(n=>{var E;return s.modeOption[n]==((E=p.Sheets.Sheet1["R"+i])==null?void 0:E.w)})),(Z=p.Sheets.Sheet1["S"+i])!=null&&Z.w&&(f[i-2].dtmf=((k=p.Sheets.Sheet1["S"+i])==null?void 0:k.w)==S("On")),(ee=p.Sheets.Sheet1["T"+i])!=null&&ee.w&&(((D=p.Sheets.Sheet1["T"+i])==null?void 0:D.w.split(",").indexOf("I"))>=0&&f[i-2].scanlist.push("I"),((d=p.Sheets.Sheet1["T"+i])==null?void 0:d.w.split(",").indexOf("II"))>=0&&f[i-2].scanlist.push("II"));t.renderData=f},o.readAsArrayBuffer(a)},e.click()};return(e,a)=>{const o=qe,x=Ke,f=Fe,v=Be,p=Ae,b=Ne,r=Ue,c=ze,C=Me,l=je,u=Xe,T=Ye,I=Ze,F=ke,_=et,P=Re;return pe(),st("div",pt,[A.value>0?(pe(),we(o,{key:0,theme:"loading",class:"midMessage"},{default:h(()=>[K("\u6B63\u5728\u6267\u884C\u4E2D("+B(A.value)+"%)",1)]),_:1})):he("",!0),m(x,{visible:te.showNotice,"onUpdate:visible":a[0]||(a[0]=w=>te.showNotice=w),onOk:Ce,onCancel:a[1]||(a[1]=w=>te.showNotice=!1)},{title:h(()=>[K(B(e.$t("menu.cps.writeNoticeTitle")),1)]),default:h(()=>[ne("div",null,B(e.$t("menu.cps.writeNoticeContent")),1)]),_:1},8,["visible"]),m(f,{items:[e.$t("menu.dashboard"),e.$t("menu.cps.channel")]},null,8,["items"]),m(P,{class:"general-card"},{title:h(()=>[ne("span",{onClick:a[2]||(a[2]=()=>{te.showHide+=1})},B(e.$t("menu.cps.channel")+e.$t("global.onStart")),1)]),default:h(()=>[m(l,{style:{"margin-bottom":"16px"}},{default:h(()=>[m(r,{span:12},{default:h(()=>[m(b,null,{default:h(()=>[m(p,{type:"primary",onClick:Oe},{icon:h(()=>[m(v)]),default:h(()=>[K(" "+B(e.$t("cps.onDeviceRead")),1)]),_:1}),m(p,{onClick:a[3]||(a[3]=w=>te.showNotice=!0)},{icon:h(()=>[m(v)]),default:h(()=>[K(" "+B(e.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1}),m(r,{span:12,style:{"text-align":"right"}},{default:h(()=>[m(b,null,{default:h(()=>[te.showHide>=5?(pe(),we(C,{key:0},{content:h(()=>[m(p,{style:{width:"200px",margin:"10px","margin-bottom":"0px"},type:"primary",onClick:ye},{default:h(()=>[...a[6]||(a[6]=[K(" \u4FDD\u5B58 ",-1)])]),_:1}),a[8]||(a[8]=ne("br",null,null,-1)),m(p,{style:{width:"200px",margin:"10px"},onClick:ve},{default:h(()=>[...a[7]||(a[7]=[K(" \u52A0\u8F7D ",-1)])]),_:1})]),default:h(()=>[m(p,null,{default:h(()=>[a[5]||(a[5]=K(" \u4FDD\u5B58/\u52A0\u8F7D\uFF08\u5DF2\u5E9F\u5F03\uFF09",-1)),m(c)]),_:1})]),_:1})):he("",!0),m(p,{type:"text",onClick:Ie},{default:h(()=>[K(B(e.$t("cps.downloadImportTemplate")),1)]),_:1}),m(p,{type:"primary",onClick:_e},{default:h(()=>[K(B(e.$t("cps.import")),1)]),_:1}),m(p,{onClick:Te},{default:h(()=>[K(B(e.$t("cps.export")),1)]),_:1})]),_:1})]),_:1})]),_:1}),m(_,{class:"ttable",loading:me(De),size:"medium",columns:ge.value,data:t.renderData,pagination:{defaultPageSize:t.pageSize,total:t.renderData.length,defaultCurrent:1,pageSizeOptions:[15,30,50,100,200]},onChange:a[4]||(a[4]=w=>{t.pageSize=w.pagination.pageSize,t.nowPage=w.pagination.current}),bordered:"","lazy-load":"",headerAffixedTop:{offsetTop:60},hover:!0,"drag-sort":"row-handler",onDragSort:xe},{drag:h(({row:w,rowIndex:O})=>[ne("span",null,[m(me(tt))])]),index:h(({row:w,rowIndex:O})=>[K(B((t.nowPage-1)*t.pageSize+O+1),1)]),reverse:h(({row:w,rowIndex:O})=>[m(u,{modelValue:w.reverse,"onUpdate:modelValue":y=>w.reverse=y},null,8,["modelValue","onUpdate:modelValue"])]),busy:h(({row:w,rowIndex:O})=>[m(u,{modelValue:w.busy,"onUpdate:modelValue":y=>w.busy=y},null,8,["modelValue","onUpdate:modelValue"])]),dtmf:h(({row:w,rowIndex:O})=>[m(u,{modelValue:w.dtmf,"onUpdate:modelValue":y=>w.dtmf=y},null,8,["modelValue","onUpdate:modelValue"])]),scanlist:h(({row:w,rowIndex:O})=>[m(I,{modelValue:w.scanlist,"onUpdate:modelValue":y=>w.scanlist=y},{default:h(()=>[m(T,{key:"I",label:"I",value:"I"}),m(T,{key:"II",label:"II",value:"II"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),operate:h(({row:w,rowIndex:O})=>[m(F,{theme:"default",variant:"dashed",onClick:y=>be((t.nowPage-1)*t.pageSize+O)},{default:h(()=>[K(B(e.$t("cps.clear")),1)]),_:1},8,["onClick"])]),_:1},8,["loading","columns","data","pagination"])]),_:1})])}}});const Qt=Pe(ct,[["__scopeId","data-v-845a490d"]]);export{Qt as default};
