import{g as N,_ as O}from"./index.b7e36261.js";import{a4 as T,U as j,R as G,n as P,d as H,W as V,a0 as $}from"./@arco-design.1f9a81c2.js";import"./vue.daf89c07.js";import{b as B}from"./vue-router.391082ef.js";import{u as z}from"./loading.bfb45974.js";import{m as M}from"./marked.12c4cbcc.js";import{p as A}from"./dompurify.558bfd80.js";import{L as F,S as I}from"./tdesign-vue-next.876353e4.js";import{d as Y,h as q,w as Q,l as W,o as p,a as w,x as r,u as n,_ as K,e as E,z as m,A as h,F as S,Q as L,s as D}from"./@vue.1cdd4af7.js";import{v as X}from"./vue-i18n.645f4f0b.js";import"./nprogress.b0a22fe3.js";import"./@intlify.d4358f23.js";import"./mitt.550594b0.js";import"./pinia.722f5e0f.js";import"./vue-demi.0f54e832.js";import"./axios.f3f20840.js";import"./@vueuse.3623d212.js";import"./aegis-web-sdk.846094f8.js";import"./@zxing.8654f0db.js";import"./vue-matomo.4c7efa96.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.f7934723.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./lodash-es.18922ecc.js";import"./tdesign-icons-vue-next.5ef165be.js";import"./sortablejs.b2e3c7c4.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";const Z={class:"container"},ee={name:"DIY"},te=Y({...ee,setup(ae){const R=B(),{t:v}=X.exports.useI18n(),U=()=>{R.push({path:"/tool/flash",query:{url:"https://k5.vicicode.cn/diyapi/LOSEHU"+e.flag.join("")+".bin?v="+new Date().getTime()}})},C=()=>{fetch("https://k5.vicicode.cn/diyapi/LOSEHU"+e.flag.join("")+".bin?v="+new Date().getTime()).then(t=>t.blob()).then(t=>{const o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download="LOSEHU-CUSTOM-"+e.flag.join("")+".bin",document.body.appendChild(i),i.click(),document.body.removeChild(i)})},e=q({versions:[],flag:[],disMatrix:[],disName:[],showSort:[],readme:""});Q(()=>[...e.flag],()=>{b()});const b=()=>{e.flag.map((t,o)=>{e.disMatrix[o].forEach((i,l)=>{e.versions.indexOf("LOSEHU"+e.flag.join("").substring(0,o)+l+e.flag.join("").substring(o+1)+".bin")==-1?e.disMatrix[o].set(l,!0):e.disMatrix[o].set(l,!1)})})},{loading:J,setLoading:k}=z(!0);return W(async()=>{k(!0);let t=await(await fetch("https://k5.vicicode.cn/diyapi/function.json?v="+new Date().getTime())).text();t=JSON.parse(t);let o=[],i=[];t.map(a=>{o[a[a.length-1]-1]=a,i.push(a[a.length-1]-1)}),t=o;let l=[],u=[];t.map(a=>{let f=new Map,c=new Map;for(let s=a[0]*2+1;s<a[0]*3+1;s++)f.set(a[s],!1),v("idea.diy")!=="LOSEHU DIY"?c.set(a[s],a[s-a[0]-a[0]]):c.set(a[s],a[s-a[0]]);l.push(f),u.push(c)}),e.flag=new Array(t.length).fill("0"),e.disName=u,e.disMatrix=l,e.showSort=i;const g=await(await fetch("https://k5.vicicode.cn/diyapi/version.json?v="+new Date().getTime())).text();e.versions=JSON.parse(g),b(),k(!1),v("menu.dashboard")=="CPS"?e.readme=A.sanitize(await M.parse(await(await fetch("https://k5.vicicode.cn/diyapi/README_en.md?v="+new Date().getTime())).text())):e.readme=A.sanitize(await M.parse(await(await fetch("https://k5.vicicode.cn/diyapi/README.md?v="+new Date().getTime())).text())),e.readme=e.readme.replaceAll('href="./README_en.md"',""),e.readme=e.readme.replaceAll('href="./README.md"',""),e.readme=e.readme.replaceAll("losehu/uv-k5-firmware-chinese/blob/main/payment/show.png","losehu/uv-k5-firmware-chinese/blob/main/payment/show.png?raw=true"),e.readme=e.readme.replaceAll("/images/c1.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c1.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c2.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c2.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c3.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c3.JPG?raw=true"),e.readme=e.readme.replaceAll("/images/c4.JPG","https://github.com/losehu/uv-k5-firmware-custom/blob/main/images/c4.JPG?raw=true"),e.readme=e.readme.replaceAll("a href",'a target="_blank" href')}),(t,o)=>{const i=N,l=F,u=G,g=P,a=H,f=T,c=I,s=j,y=V,x=$;return p(),w("div",Z,[r(i,{items:[t.$t("menu.workshop"),t.$t("idea.diy")]},null,8,["items"]),r(x,{gutter:20,align:"stretch"},{default:n(()=>[r(y,{span:24},{default:n(()=>[r(s,{class:"general-card",title:t.$t("idea.diy"),loading:K(J)},{default:n(()=>[r(c,{direction:"vertical"},{default:n(()=>[E("div",null,[m(h(t.$t("oi")),1),r(l,{theme:"primary",href:"https://github.com/losehu/uv-k5-firmware-custom",target:"_blank"},{default:n(()=>[m("https://github.com/losehu/uv-k5-firmware-custom")]),_:1})]),(p(!0),w(S,null,L(e.showSort,_=>(p(),D(g,{modelValue:e.flag[_],"onUpdate:modelValue":d=>e.flag[_]=d,type:"button"},{default:n(()=>[(p(!0),w(S,null,L(e.disMatrix[_],d=>(p(),D(u,{value:d[0],disabled:d[1]},{default:n(()=>[m(h(e.disName[_].get(d[0])),1)]),_:2},1032,["value","disabled"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"]))),256)),E("div",null,[r(a,{type:"primary",onClick:U},{default:n(()=>[m(h(t.$t("diy.generate")),1)]),_:1}),m("\xA0\xA0 "),r(f,{onClick:C},{default:n(()=>[m(h(t.$t("global.download")),1)]),_:1})])]),_:1})]),_:1},8,["title","loading"])]),_:1})]),_:1}),r(x,{gutter:20,align:"stretch",style:{"margin-top":"10px"}},{default:n(()=>[r(y,{span:24},{default:n(()=>[r(s,{style:{padding:"20px"},class:"general-card readme",innerHTML:e.readme},null,8,["innerHTML"])]),_:1})]),_:1})])}}});const Oe=O(te,[["__scopeId","data-v-2c3f2359"]]);export{Oe as default};
