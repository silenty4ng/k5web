import{d as U,g as H,_ as L}from"./index.7338e5f3.js";import{P as M,Y as N,d as V,k as O,U as j,_ as G}from"./@arco-design.5e2b2073.js";import"./vue.83b9e9de.js";import{u as W}from"./loading.3552afe6.js";import{e as S,a as h,u as w,f as Y,h as D,s as Z,b as y,g as q}from"./serial.1e70c626.js";import{I as b,B as F,T as J}from"./tdesign-vue-next.de6f3c5b.js";import{G as Q}from"./tdesign-icons-vue-next.6eb4e7b8.js";import{d as X,h as v,c as tt,o as et,a as at,x as s,u as r,e as P,A as m,z as g,_ as C}from"./@vue.2faf1d8e.js";import{v as ot}from"./vue-i18n.3095106f.js";import"./vue-echarts.5aab67d4.js";import"./resize-detector.a8854a64.js";import"./echarts.5b0e6023.js";import"./zrender.ce26131e.js";import"./tslib.c6ba9914.js";import"./vue-router.2630bdf9.js";import"./nprogress.b0a22fe3.js";import"./@intlify.d4358f23.js";import"./mitt.550594b0.js";import"./pinia.84b4adc6.js";import"./vue-demi.61f15e01.js";import"./axios.f3f20840.js";import"./@vueuse.7fb11548.js";import"./aegis-web-sdk.846094f8.js";import"./@zxing.8654f0db.js";import"./vue-matomo.4c7efa96.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.4c867136.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./sortablejs.b2e3c7c4.js";import"./@popperjs.f3f73334.js";const nt={class:"container"},rt={name:"Mdc"},it=X({...rt,setup(st){const{t:f}=ot.exports.useI18n(),n=U(),{loading:z,setLoading:u}=W(!1),a=v({renderData:Array.from({length:16}).map(t=>({})),pageSize:16,nowPage:1}),I=v({showHide:0}),A=t=>{a.renderData=t.newData},R=tt(()=>[{colKey:"drag",title:f("cps.sort"),width:46},{title:"#",colKey:"index",align:"left",width:100},{title:f("cps.contact"),colKey:"name",width:250,align:"left",cell:(t,{row:e})=>e.name?e.name.replace(/[^a-zA-Z0-9_]/g,""):void 0,edit:{component:b,props:{clearable:!0},onEdited:t=>{const e=[...a.renderData];e.splice((a.nowPage-1)*a.pageSize+t.rowIndex,1,t.newRowData),a.renderData=e}}},{title:f("cps.mdcid"),colKey:"mdcid",align:"left",width:200,cell:(t,{row:e})=>parseInt(e.mdcid,16)<=65535?parseInt(e.mdcid,16).toString(16):void 0,edit:{component:b,props:{clearable:!0},onEdited:t=>{t.newRowData.mdcid=t.newRowData.mdcid?t.newRowData.mdcid.toLowerCase():void 0;const e=[...a.renderData];e.splice((a.nowPage-1)*a.pageSize+t.rowIndex,1,t.newRowData),a.renderData=e}}},{title:f("cps.operate"),colKey:"operate",align:"left",width:150}]),T=async()=>{var d,c;if(n.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await S(n.connectPort),u(!0);let t=new Uint8Array(256);for(let o=7424;o<7680;o+=16){const i=await h(n.connectPort,o,16,(d=n.configuration)==null?void 0:d.uart);t.set(i,o-7424)}const e=[];for(let o=0;o<256;o+=16)w(t.subarray(o,o+2))!="ffff"?e.push({name:Y(t.subarray(o+2,o+16),(c=n.configuration)==null?void 0:c.charset).trim(),mdcid:w(t.subarray(o,o+1))+w(t.subarray(o+1,o+2))}):e.push({});a.renderData=e,u(!1)},$=async()=>{var e,d,c,o;if(n.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await S(n.connectPort),u(!0);for(let i=0;i<256;i+=16)if(a.renderData[i/16].mdcid){const p=new Uint8Array(16).fill(32);p.set(D(a.renderData[i/16].mdcid.padStart(4,"0").substring(0,2))),p.set(D(a.renderData[i/16].mdcid.padStart(4,"0").substring(2,4)),1),p.set(Z(a.renderData[i/16].name),2),await y(n.connectPort,i+7424,p,16,(e=n.configuration)==null?void 0:e.uart)}else await y(n.connectPort,i+7424,D("ffffffffffffffffffffffffffffffff"),16,(d=n.configuration)==null?void 0:d.uart);const t=await h(n.connectPort,8176,16,(c=n.configuration)==null?void 0:c.uart);t.set([16],16-1),await y(n.connectPort,8176,t,16,(o=n.configuration)==null?void 0:o.uart),await q(n.connectPort),u(!1)},k=async t=>{const e=[...a.renderData];e.splice(t,1,{scanlist:[]}),a.renderData=e};return(t,e)=>{const d=H,c=N,o=V,i=O,p=j,x=G,B=F,K=J,E=M;return et(),at("div",nt,[s(d,{items:[t.$t("menu.dashboard"),t.$t("menu.cps.mdc")]},null,8,["items"]),s(E,{class:"general-card"},{title:r(()=>[P("span",{onClick:e[0]||(e[0]=()=>{I.showHide+=1})},m(t.$t("menu.cps.mdc")+t.$t("global.onStart")),1)]),default:r(()=>[s(x,{style:{"margin-bottom":"16px"}},{default:r(()=>[s(p,{span:12},{default:r(()=>[s(i,null,{default:r(()=>[s(o,{type:"primary",onClick:T},{icon:r(()=>[s(c)]),default:r(()=>[g(" "+m(t.$t("cps.onDeviceRead")),1)]),_:1}),s(o,{onClick:$},{icon:r(()=>[s(c)]),default:r(()=>[g(" "+m(t.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(K,{class:"ttable",loading:C(z),size:"medium",columns:R.value,data:a.renderData,pagination:{defaultPageSize:a.pageSize,total:a.renderData.length,defaultCurrent:1,pageSizeOptions:[15,30,50,100,200]},onChange:e[1]||(e[1]=l=>{a.pageSize=l.pagination.pageSize,a.nowPage=l.pagination.current}),bordered:"","lazy-load":"",headerAffixedTop:{offsetTop:60},hover:!0,"drag-sort":"row-handler",onDragSort:A},{drag:r(({row:l,rowIndex:_})=>[P("span",null,[s(C(Q))])]),index:r(({row:l,rowIndex:_})=>[g(m((a.nowPage-1)*a.pageSize+_+1),1)]),operate:r(({row:l,rowIndex:_})=>[s(B,{theme:"default",variant:"dashed",onClick:ct=>k((a.nowPage-1)*a.pageSize+_)},{default:r(()=>[g(m(t.$t("cps.clear")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","columns","data","pagination"])]),_:1})])}}});const Ot=L(it,[["__scopeId","data-v-2223802a"]]);export{Ot as default};
