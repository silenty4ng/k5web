import{d as Fe,g as Re,_ as Pe}from"./index.a1ade083.js";import{U as Ke,f as Be,_ as Ae,d as Ne,k as Ue,W as ze,$ as Me,m as je,a0 as Ve}from"./@arco-design.1f9a81c2.js";import"./vue.daf89c07.js";import{u as $e}from"./vue-router.391082ef.js";import{u as Le}from"./loading.bfb45974.js";import{e as Se,a as oe,u as ue,f as He,h as ie,s as Ge,b as se,g as Je}from"./serial.0b46e76d.js";import{c as Qe}from"./chinese-s2t.a9ab083b.js";import{r as de,w as We}from"./xlsx.fbaab35d.js";import{I as pe,c as P,M as qe,d as Xe,f as Ye,g as Ze,B as ke,T as et}from"./tdesign-vue-next.876353e4.js";import{G as tt}from"./tdesign-icons-vue-next.5ef165be.js";import{d as at,r as nt,h as we,a9 as rt,l as ot,c as it,o as le,a as st,s as he,u as w,z as K,A as B,v as me,x as m,e as re,_ as De,b9 as dt,b8 as pt}from"./@vue.1cdd4af7.js";import{v as lt}from"./vue-i18n.645f4f0b.js";import"./nprogress.b0a22fe3.js";import"./@intlify.d4358f23.js";import"./mitt.550594b0.js";import"./pinia.722f5e0f.js";import"./vue-demi.0f54e832.js";import"./axios.f3f20840.js";import"./@vueuse.3623d212.js";import"./aegis-web-sdk.846094f8.js";import"./@zxing.8654f0db.js";import"./vue-matomo.4c7efa96.js";import"./b-tween.8dd4e2fe.js";import"./dayjs.f7934723.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";import"./lodash-es.18922ecc.js";import"./sortablejs.b2e3c7c4.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";const ct=ae=>(dt("data-v-9d30e610"),ae=ae(),pt(),ae),ft={class:"container"},St=ct(()=>re("br",null,null,-1)),ut={name:"SearchTable"},wt=at({...ut,setup(ae){const{t:u}=lt.exports.useI18n(),O=Fe(),{loading:xe,setLoading:ne}=Le(!1),A=nt(0),s={bandwidthOption:{0:"25KHz",1:"12.5KHz"},modeOption:{0:"FM",1:"AM",2:"USB"},powerOptionEng:{0:"Low",1:"Med",2:"High"},powerOption:{0:"\u4F4E",1:"\u4E2D",2:"\u9AD8"},toneOptionEng:{1:"Tone",2:"DTCS(N)",3:"DTCS(I)"},toneOption:{1:"\u4E9A\u97F3\u9891",2:"\u6570\u5B57\u4E9A\u97F3",3:"\u53CD\u5411\u6570\u5B57\u4E9A\u97F3"},CTCSSOption:[67,69.3,71.9,74.4,77,79.7,82.5,85.4,88.5,91.5,94.8,97.4,100,103.5,107.2,110.9,114.8,118.8,123,127.3,131.8,136.5,141.3,146.2,151.4,156.7,159.8,162.2,165.5,167.9,171.3,173.8,177.3,179.9,183.5,186.2,189.9,192.8,196.6,199.5,203.5,206.5,210.7,218.1,225.7,229.1,233.6,241.8,250.3,254.1],DCSOption:[23,25,26,31,32,36,43,47,51,53,54,65,71,72,73,74,114,115,116,122,125,131,132,134,143,145,152,155,156,162,165,172,174,205,212,223,225,226,243,244,245,246,251,252,255,261,263,265,266,271,274,306,311,315,325,331,332,343,346,351,356,364,365,371,411,412,413,423,431,432,445,446,452,454,455,462,464,465,466,503,506,516,523,526,532,546,565,606,612,624,627,631,632,654,662,664,703,712,723,731,732,734,743,754],stepOption:[2.5,5,6.25,10,12.5,25,8.33,.01,.05,.1,.25,.5,1,1.25,9,15,20,30,50,100,125,200,250,500],scrambOption:["1","2","3","4","5","6","7","8","9","10"],pttidOptionEng:["UP CODE","DOWW CODE","UP+DOWN Code","APOLLO QUINDAR"],pttidOption:["\u4E0A\u7EBF\u7801","\u4E0B\u7EBF\u7801","\u4E0A\u7EBF+\u4E0B\u7EBF\u7801","Quindar\u7801"]},t=we({renderData:Array.from({length:200}).map(e=>({scanlist:[]})),pageSize:15,nowPage:1}),te=we({showHide:0,showNotice:!1}),Oe=e=>{t.renderData=e.newData},ce=$e();rt(()=>{u("menu.dashboard")=="CPS"&&(s.powerOption=s.powerOptionEng,s.toneOption=s.toneOptionEng,s.pttidOption=s.pttidOptionEng)}),ot(async()=>{var n,o,x,f,v,a,g,S,l,c,p,C,I,_,E,R,F,h,b,y,U,z,M,j,V,$,L,H,G,J,Q,W,q,X,Y;if(ce.query.url){const N=await fetch(ce.query.url),Z=(n=N==null?void 0:N.body)==null?void 0:n.getReader();if(Z){const k=[];for(;;){const{done:d,value:i}=await Z.read();if(d)break;k.push(...i)}const ee=new Uint8Array(k);var e=de(ee);const D=Array.from({length:200}).map(d=>({scanlist:[]}));for(let d=2;d<202;d++)(o=e.Sheets.Sheet1["B"+d])!=null&&o.w&&(D[d-2].name=(x=e.Sheets.Sheet1["B"+d])==null?void 0:x.w),(f=e.Sheets.Sheet1["C"+d])!=null&&f.w&&(D[d-2].bandwidth=Object.keys(s.bandwidthOption).find(i=>{var r;return s.bandwidthOption[i]==((r=e.Sheets.Sheet1["C"+d])==null?void 0:r.w)})),(v=e.Sheets.Sheet1["D"+d])!=null&&v.w&&(D[d-2].rx=(a=e.Sheets.Sheet1["D"+d])==null?void 0:a.w),(g=e.Sheets.Sheet1["E"+d])!=null&&g.w&&(D[d-2].tx=(S=e.Sheets.Sheet1["E"+d])==null?void 0:S.w),(l=e.Sheets.Sheet1["F"+d])!=null&&l.w&&(D[d-2].power=Object.keys(s.powerOption).find(i=>{var r;return s.powerOption[i]==((r=e.Sheets.Sheet1["F"+d])==null?void 0:r.w)})),(c=e.Sheets.Sheet1["G"+d])!=null&&c.w&&(D[d-2].rxTone=Object.keys(s.toneOption).find(i=>{var r;return s.toneOption[i]==((r=e.Sheets.Sheet1["G"+d])==null?void 0:r.w)})),(p=e.Sheets.Sheet1["H"+d])!=null&&p.w&&(D[d-2].rxCTCSS=parseFloat((C=e.Sheets.Sheet1["H"+d])==null?void 0:C.w)),(I=e.Sheets.Sheet1["I"+d])!=null&&I.w&&(D[d-2].rxDCS=parseFloat((_=e.Sheets.Sheet1["I"+d])==null?void 0:_.w)),(E=e.Sheets.Sheet1["J"+d])!=null&&E.w&&(D[d-2].txTone=Object.keys(s.toneOption).find(i=>{var r;return s.toneOption[i]==((r=e.Sheets.Sheet1["J"+d])==null?void 0:r.w)})),(R=e.Sheets.Sheet1["K"+d])!=null&&R.w&&(D[d-2].txCTCSS=parseFloat((F=e.Sheets.Sheet1["K"+d])==null?void 0:F.w)),(h=e.Sheets.Sheet1["L"+d])!=null&&h.w&&(D[d-2].txDCS=parseFloat((b=e.Sheets.Sheet1["L"+d])==null?void 0:b.w)),(y=e.Sheets.Sheet1["M"+d])!=null&&y.w&&(D[d-2].step=parseFloat((U=e.Sheets.Sheet1["M"+d])==null?void 0:U.w)),(z=e.Sheets.Sheet1["N"+d])!=null&&z.w&&(D[d-2].reverse=((M=e.Sheets.Sheet1["N"+d])==null?void 0:M.w)==u("On")),(j=e.Sheets.Sheet1["O"+d])!=null&&j.w&&(D[d-2].scramb=parseFloat((V=e.Sheets.Sheet1["O"+d])==null?void 0:V.w)),($=e.Sheets.Sheet1["P"+d])!=null&&$.w&&(D[d-2].busy=((L=e.Sheets.Sheet1["P"+d])==null?void 0:L.w)==u("On")),(H=e.Sheets.Sheet1["Q"+d])!=null&&H.w&&(D[d-2].pttid=(G=e.Sheets.Sheet1["Q"+d])==null?void 0:G.w),(J=e.Sheets.Sheet1["R"+d])!=null&&J.w&&(D[d-2].mode=Object.keys(s.modeOption).find(i=>{var r;return s.modeOption[i]==((r=e.Sheets.Sheet1["R"+d])==null?void 0:r.w)})),(Q=e.Sheets.Sheet1["S"+d])!=null&&Q.w&&(D[d-2].dtmf=((W=e.Sheets.Sheet1["S"+d])==null?void 0:W.w)==u("On")),(q=e.Sheets.Sheet1["T"+d])!=null&&q.w&&(((X=e.Sheets.Sheet1["T"+d])==null?void 0:X.w.split(",").indexOf("I"))>=0&&D[d-2].scanlist.push("I"),((Y=e.Sheets.Sheet1["T"+d])==null?void 0:Y.w.split(",").indexOf("II"))>=0&&D[d-2].scanlist.push("II"));t.renderData=D}}});const ge=it(()=>[{colKey:"drag",title:u("cps.sort"),width:46},{title:"#",colKey:"index",align:"left",width:100},{title:u("cps.name"),colKey:"name",width:250,align:"left",edit:{component:pe,props:{clearable:!0},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.bandwidth"),colKey:"bandwidth",align:"left",width:150,cell:(e,{row:n})=>{var o;return(o=s.bandwidthOption[n.bandwidth])!=null?o:""},edit:{component:P,props:{clearable:!0,options:Object.keys(s.bandwidthOption).map(e=>({value:e,label:s.bandwidthOption[e]}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.rx"),colKey:"rx",align:"left",width:200,cell:(e,{row:n})=>parseFloat(n.rx)?parseFloat(n.rx).toFixed(5):void 0,edit:{component:pe,props:{clearable:!0},onEdited:e=>{e.newRowData.rx=e.newRowData.rx?e.newRowData.rx:void 0;const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.tx"),colKey:"tx",align:"left",width:200,cell:(e,{row:n})=>parseFloat(n.tx)?parseFloat(n.tx).toFixed(5):void 0,edit:{component:pe,props:{clearable:!0},onEdited:e=>{e.newRowData.tx=e.newRowData.tx?e.newRowData.tx:void 0;const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.power"),colKey:"power",align:"left",width:150,cell:(e,{row:n})=>{var o;return(o=s.powerOption[n.power])!=null?o:""},edit:{component:P,props:{clearable:!0,options:Object.keys(s.powerOption).map(e=>({value:e,label:s.powerOption[e]}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.rxToneType"),colKey:"rxTone",align:"left",width:180,cell:(e,{row:n})=>{var o;return(o=s.toneOption[n.rxTone])!=null?o:""},edit:{component:P,props:{clearable:!0,options:Object.keys(s.toneOption).map(e=>({value:e,label:s.toneOption[e]}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.rxToneCTCSS"),colKey:"rxCTCSS",align:"left",width:150,cell:(e,{row:n})=>{var o;return s.CTCSSOption.indexOf(n.rxCTCSS)>=0?(o=n.rxCTCSS)==null?void 0:o.toFixed(1):void 0},edit:{component:P,props:{clearable:!0,options:s.CTCSSOption.map(e=>({value:e,label:e.toFixed(1)}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.rxToneDCS"),colKey:"rxDCS",align:"left",width:150,cell:(e,{row:n})=>s.DCSOption.indexOf(n.rxDCS)>=0?"0"+n.rxDCS:void 0,edit:{component:P,props:{clearable:!0,options:s.DCSOption.map(e=>({value:e,label:"0"+e}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.txToneType"),colKey:"txTone",align:"left",width:180,cell:(e,{row:n})=>{var o;return(o=s.toneOption[n.txTone])!=null?o:""},edit:{component:P,props:{clearable:!0,options:Object.keys(s.toneOption).map(e=>({value:e,label:s.toneOption[e]}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.txToneCTCSS"),colKey:"txCTCSS",align:"left",width:150,cell:(e,{row:n})=>{var o;return s.CTCSSOption.indexOf(n.txCTCSS)>=0?(o=n.txCTCSS)==null?void 0:o.toFixed(1):void 0},edit:{component:P,props:{clearable:!0,options:s.CTCSSOption.map(e=>({value:e,label:e.toFixed(1)}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.txToneDCS"),colKey:"txDCS",align:"left",width:150,cell:(e,{row:n})=>s.DCSOption.indexOf(n.txDCS)>=0?"0"+n.txDCS:void 0,edit:{component:P,props:{clearable:!0,options:s.DCSOption.map(e=>({value:e,label:"0"+e}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.step"),colKey:"step",align:"left",width:150,cell:(e,{row:n})=>{var o;return s.stepOption.indexOf(n.step)>=0?(o=n.step)==null?void 0:o.toFixed(2):void 0},edit:{component:P,props:{clearable:!0,options:s.stepOption.map(e=>({value:e,label:e.toFixed(2)}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.reverse"),colKey:"reverse",align:"left",width:150},{title:u("cps.scramb"),colKey:"scramb",align:"left",width:150,edit:{component:P,props:{clearable:!0,options:s.scrambOption.map(e=>({value:e,label:e}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.busy"),colKey:"busy",align:"left",width:150},{title:u("cps.pttid"),colKey:"pttid",align:"left",width:150,edit:{component:P,props:{clearable:!0,options:s.pttidOption.map(e=>({value:e,label:e}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.mode"),colKey:"mode",align:"left",width:150,cell:(e,{row:n})=>{var o;return(o=s.modeOption[n.mode])!=null?o:""},edit:{component:P,props:{clearable:!0,options:Object.keys(s.modeOption).map(e=>({value:e,label:s.modeOption[e]}))},onEdited:e=>{const n=[...t.renderData];n.splice((t.nowPage-1)*t.pageSize+e.rowIndex,1,e.newRowData),t.renderData=n}}},{title:u("cps.dtmf"),colKey:"dtmf",align:"left",width:150},{title:u("cps.scanlist"),colKey:"scanlist",align:"left",width:150},{title:u("cps.operate"),colKey:"operate",align:"left",width:150}]),fe=[50,108,136,174,350,400,470],Ce=async()=>{var f,v,a,g;if(O.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await Se(O.connectPort),ne(!0),A.value=0;let e=new Uint8Array(3200);for(let S=0;S<3200;S+=64){A.value+=1;const l=await oe(O.connectPort,S,64,(f=O.configuration)==null?void 0:f.uart);e.set(l,S)}let n=new Uint8Array(192);for(let S=3424;S<3616;S+=64){const l=await oe(O.connectPort,S,64,(v=O.configuration)==null?void 0:v.uart);n.set(l,S-3424)}let o=new Uint8Array(3200);for(let S=3920;S<7120;S+=64){A.value+=1;const l=await oe(O.connectPort,S,64,(a=O.configuration)==null?void 0:a.uart);o.set(l,S-3920)}const x=[];for(let S=0;S<3200;S+=16){const l=ue(e.subarray(S,S+16)),c=ue(n.subarray(S/16,S/16+1)),p={scanlist:[]};p.rx=l.substr(24,8)!="ffffffff"?parseInt(l.substr(24,8),16)/1e5:void 0,p.rx&&c!="ff"&&c!="0f"?(console.info(l),console.info(c),p.offset=l.substr(16,8)!="00000000"?parseInt(l.substr(16,8),16)/1e5:void 0,p.txcodeflag=l.substr(9,1),p.txcodeflag=="1"&&(p.tx=p.rx+p.offset),p.txcodeflag=="2"&&(p.tx=p.rx-p.offset),p.txTone=parseInt(l.substr(10,1),16)>0?parseInt(l.substr(10,1),16).toString():void 0,p.rxTone=parseInt(l.substr(11,1),16)>0?parseInt(l.substr(11,1),16).toString():void 0,p.txTone=="1"&&(p.txCTCSS=s.CTCSSOption[parseInt(l.substr(12,2),16)]),(p.txTone=="2"||p.txTone=="3")&&(p.txDCS=s.DCSOption[parseInt(l.substr(12,2),16)]),p.rxTone=="1"&&(p.rxCTCSS=s.CTCSSOption[parseInt(l.substr(14,2),16)]),(p.rxTone=="2"||p.rxTone=="3")&&(p.rxDCS=s.DCSOption[parseInt(l.substr(14,2),16)]),p.step=s.stepOption[parseInt(l.substr(2,2),16)],p.scramb=parseInt(l.substr(0,2),16)>0?parseInt(l.substr(0,2),16).toString():void 0,p.power_reverse_busy_width=parseInt(l.substr(6,2),16),p.reverse=!!(p.power_reverse_busy_width>>0&1),p.bandwidth=(p.power_reverse_busy_width>>1&1).toString(),p.power=(p.power_reverse_busy_width>>2&3).toString(),p.busy=!!(p.power_reverse_busy_width>>4&1),p.pttid_dtmf=parseInt(l.substr(4,2),16),p.pttid=s.pttidOption[(p.pttid_dtmf>>1)-1],p.dtmf=!!(p.pttid_dtmf>>0&1),p.mode=parseInt(l.substr(8,1),16).toString(),p.name=He(o.subarray(S,S+16),(g=O.configuration)==null?void 0:g.charset),parseInt(c.substr(0,1),16)&8&&p.scanlist.push("I"),parseInt(c.substr(0,1),16)&4&&p.scanlist.push("II")):p.rx=void 0,x.push(p)}t.renderData=x,ne(!1),A.value=0},be=async()=>{var f,v;if(O.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}await Se(O.connectPort),ne(!0),A.value=0;let e=new Uint8Array(3200),n=new Uint8Array(200),o=new Uint8Array(3200),x=0;t.renderData.map(a=>{var g,S,l;if(a.rx){let c="";c+=parseInt(a.scramb)>0?parseInt(a.scramb).toString(16).padStart(2,"0"):"00",c+=s.stepOption.indexOf(a.step)>=0?s.stepOption.indexOf(a.step).toString(16).padStart(2,"0"):"00";let p=s.pttidOption.indexOf(a.pttid)+1<<1;p+=a.dtmf?1:0,c+=p.toString(16).padStart(2,"0");let C=a.busy?1<<4:0;switch(C+=a.power<<2,C+=a.bandwidth<<1,C+=a.reverse?1:0,c+=C.toString(16).padStart(2,"0"),c+=a.mode?a.mode.toString(16):"0",a.tx>0&&a.tx>a.rx?c+="1":a.tx>0&&a.tx<a.rx?c+="2":c+="0",c+=parseInt(a.txTone)>0?a.txTone.toString(16):"0",c+=parseInt(a.rxTone)>0?a.rxTone.toString(16):"0",a.txTone){case"1":c+=s.CTCSSOption.indexOf(a.txCTCSS).toString(16).padStart(2,"0");break;case"2":case"3":c+=s.DCSOption.indexOf(a.txDCS).toString(16).padStart(2,"0");break;default:c+="00"}switch(a.rxTone){case"1":c+=s.CTCSSOption.indexOf(a.rxCTCSS).toString(16).padStart(2,"0");break;case"2":case"3":c+=s.DCSOption.indexOf(a.rxDCS).toString(16).padStart(2,"0");break;default:c+="00"}const I=a.tx&&a.rx?Math.abs(parseInt((a.tx*1e5).toFixed(0))-parseInt((a.rx*1e5).toFixed(0))):NaN;c+=Number.isNaN(I)?"00000000":I.toString(16).padStart(8,"0"),c+=parseInt((a.rx*1e5).toFixed(0)).toString(16).padStart(8,"0"),c.indexOf("-1")!=-1&&(c=c.replace(/^(.{10})(.{6})(.*)$/,"$1000000$3")),console.log(c),e.set(ie(c),x);let _=0;((g=a.scanlist)==null?void 0:g.indexOf("I"))>=0&&(_+=8),((S=a.scanlist)==null?void 0:S.indexOf("II"))>=0&&(_+=4),n.set([(_<<4)+fe.indexOf(fe.reduce((R,F)=>F<a.rx?F:R))],x/16);const E=new Uint8Array(16);E.set(Ge(a.name?Qe.t2s(a.name):"",(l=O.configuration)==null?void 0:l.charset).subarray(0,16),0),o.set(E,x)}else e.set(ie("ffffffffffffffffffffffffffffffff"),x),n.set([255],x/16),o.set(ie("ffffffffffffffffffffffffffffffff"),x);x+=16});for(let a=0;a<3200;a+=64)A.value+=1,await se(O.connectPort,a,e.slice(a,a+64),64,(f=O.configuration)==null?void 0:f.uart);await se(O.connectPort,3424,n,200);for(let a=3920;a<7120;a+=64)A.value+=1,await se(O.connectPort,a,o.slice(a-3920,a-3920+64),64,(v=O.configuration)==null?void 0:v.uart);await Je(O.connectPort),ne(!1),A.value=0},ye=async e=>{const n=[...t.renderData];n.splice(e,1,{scanlist:[]}),t.renderData=n},ve=()=>{const e=JSON.stringify(t.renderData),n=new Blob([e],{type:"application/octet-stream"}),o=URL.createObjectURL(n),x=document.createElement("a");x.download="channel.json",x.href=o,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(o)},Ie=()=>{const e=document.createElement("input");e.type="file",e.onchange=async()=>{const o=await new Blob([e.files[0]],{type:"application/octet-stream"}).text();t.renderData=JSON.parse(o)},e.click()},_e=()=>{const e=document.createElement("a");e.href="/K5Channel.xlsx",u("menu.dashboard")=="CPS"&&(e.href="/K5Channel_EN.xlsx"),e.download="K5Channel.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},Te=async()=>{var v,a,g,S,l,c,p,C,I,_,E,R,F,h,b,y,U,z,M,j,V,$,L,H,G,J,Q,W,q,X,Y,N,Z,k,ee,D,d,i;let e;u("menu.dashboard")=="CPS"?e=await fetch("/K5Channel_EN.xlsx"):e=await fetch("/K5Channel.xlsx");const n=de(await e.arrayBuffer()),o=n.Sheets[n.SheetNames[0]];for(let r=2;r<202;r++)(v=t.renderData[r-2])!=null&&v.name&&(o["B"+r]={},o["B"+r].v=(a=t.renderData[r-2])==null?void 0:a.name),(g=t.renderData[r-2])!=null&&g.bandwidth&&(o["C"+r]={},o["C"+r].v=s.bandwidthOption[(S=t.renderData[r-2])==null?void 0:S.bandwidth]),(l=t.renderData[r-2])!=null&&l.rx&&(o["D"+r]={},o["D"+r].v=(c=t.renderData[r-2])==null?void 0:c.rx),(p=t.renderData[r-2])!=null&&p.tx&&(o["E"+r]={},o["E"+r].v=(C=t.renderData[r-2])==null?void 0:C.tx),(I=t.renderData[r-2])!=null&&I.power&&(o["F"+r]={},o["F"+r].v=s.powerOption[(_=t.renderData[r-2])==null?void 0:_.power]),(E=t.renderData[r-2])!=null&&E.rxTone&&(o["G"+r]={},o["G"+r].v=s.toneOption[(R=t.renderData[r-2])==null?void 0:R.rxTone]),(F=t.renderData[r-2])!=null&&F.rxCTCSS&&(o["H"+r]={},o["H"+r].v=(h=t.renderData[r-2])==null?void 0:h.rxCTCSS),(b=t.renderData[r-2])!=null&&b.rxDCS&&(o["I"+r]={},o["I"+r].v=(y=t.renderData[r-2])==null?void 0:y.rxDCS),(U=t.renderData[r-2])!=null&&U.txTone&&(o["J"+r]={},o["J"+r].v=s.toneOption[(z=t.renderData[r-2])==null?void 0:z.txTone]),(M=t.renderData[r-2])!=null&&M.txCTCSS&&(o["K"+r]={},o["K"+r].v=(j=t.renderData[r-2])==null?void 0:j.txCTCSS),(V=t.renderData[r-2])!=null&&V.txDCS&&(o["L"+r]={},o["L"+r].v=($=t.renderData[r-2])==null?void 0:$.txDCS),(L=t.renderData[r-2])!=null&&L.step&&(o["M"+r]={},o["M"+r].v=(H=t.renderData[r-2])==null?void 0:H.step),(G=t.renderData[r-2])!=null&&G.reverse&&(o["N"+r]={},o["N"+r].v=((J=t.renderData[r-2])==null?void 0:J.reverse)==!0?u("On"):u("Off")),(Q=t.renderData[r-2])!=null&&Q.scramb&&(o["O"+r]={},o["O"+r].v=(W=t.renderData[r-2])==null?void 0:W.scramb),(q=t.renderData[r-2])!=null&&q.busy&&(o["P"+r]={},o["P"+r].v=((X=t.renderData[r-2])==null?void 0:X.busy)==!0?u("On"):u("Off")),(Y=t.renderData[r-2])!=null&&Y.pttid&&(o["Q"+r]={},o["Q"+r].v=(N=t.renderData[r-2])==null?void 0:N.pttid),(Z=t.renderData[r-2])!=null&&Z.mode&&(o["R"+r]={},o["R"+r].v=s.modeOption[(k=t.renderData[r-2])==null?void 0:k.mode]),(ee=t.renderData[r-2])!=null&&ee.dtmf&&(o["S"+r]={},o["S"+r].v=((D=t.renderData[r-2])==null?void 0:D.dtmf)==!0?u("On"):u("Off")),(d=t.renderData[r-2])!=null&&d.scanlist&&(o["T"+r]={},o["T"+r].v=(i=t.renderData[r-2])==null?void 0:i.scanlist.join(","));const x=new Blob([We(n,{type:"buffer"})],{type:"application/octet-stream"}),f=document.createElement("a");f.href=URL.createObjectURL(x),f.download="K5Channel.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)},Ee=()=>{const e=document.createElement("input");e.type="file",e.onchange=async()=>{const n=new Blob([e.files[0]],{type:"application/octet-stream"}),o=new FileReader;o.onload=function(x){var g,S,l,c,p,C,I,_,E,R,F,h,b,y,U,z,M,j,V,$,L,H,G,J,Q,W,q,X,Y,N,Z,k,ee,D,d;const f=Array.from({length:200}).map(i=>({scanlist:[]}));var v=(g=x.target)==null?void 0:g.result,a=de(v);for(let i=2;i<202;i++)(S=a.Sheets.Sheet1["B"+i])!=null&&S.w&&(f[i-2].name=(l=a.Sheets.Sheet1["B"+i])==null?void 0:l.w),(c=a.Sheets.Sheet1["C"+i])!=null&&c.w&&(f[i-2].bandwidth=Object.keys(s.bandwidthOption).find(r=>{var T;return s.bandwidthOption[r]==((T=a.Sheets.Sheet1["C"+i])==null?void 0:T.w)})),(p=a.Sheets.Sheet1["D"+i])!=null&&p.w&&(f[i-2].rx=(C=a.Sheets.Sheet1["D"+i])==null?void 0:C.w),(I=a.Sheets.Sheet1["E"+i])!=null&&I.w&&(f[i-2].tx=(_=a.Sheets.Sheet1["E"+i])==null?void 0:_.w),(E=a.Sheets.Sheet1["F"+i])!=null&&E.w&&(f[i-2].power=Object.keys(s.powerOption).find(r=>{var T;return s.powerOption[r]==((T=a.Sheets.Sheet1["F"+i])==null?void 0:T.w)})),(R=a.Sheets.Sheet1["G"+i])!=null&&R.w&&(f[i-2].rxTone=Object.keys(s.toneOption).find(r=>{var T;return s.toneOption[r]==((T=a.Sheets.Sheet1["G"+i])==null?void 0:T.w)})),(F=a.Sheets.Sheet1["H"+i])!=null&&F.w&&(f[i-2].rxCTCSS=parseFloat((h=a.Sheets.Sheet1["H"+i])==null?void 0:h.w)),(b=a.Sheets.Sheet1["I"+i])!=null&&b.w&&(f[i-2].rxDCS=parseFloat((y=a.Sheets.Sheet1["I"+i])==null?void 0:y.w)),(U=a.Sheets.Sheet1["J"+i])!=null&&U.w&&(f[i-2].txTone=Object.keys(s.toneOption).find(r=>{var T;return s.toneOption[r]==((T=a.Sheets.Sheet1["J"+i])==null?void 0:T.w)})),(z=a.Sheets.Sheet1["K"+i])!=null&&z.w&&(f[i-2].txCTCSS=parseFloat((M=a.Sheets.Sheet1["K"+i])==null?void 0:M.w)),(j=a.Sheets.Sheet1["L"+i])!=null&&j.w&&(f[i-2].txDCS=parseFloat((V=a.Sheets.Sheet1["L"+i])==null?void 0:V.w)),($=a.Sheets.Sheet1["M"+i])!=null&&$.w&&(f[i-2].step=parseFloat((L=a.Sheets.Sheet1["M"+i])==null?void 0:L.w)),(H=a.Sheets.Sheet1["N"+i])!=null&&H.w&&(f[i-2].reverse=((G=a.Sheets.Sheet1["N"+i])==null?void 0:G.w)==u("On")),(J=a.Sheets.Sheet1["O"+i])!=null&&J.w&&(f[i-2].scramb=parseFloat((Q=a.Sheets.Sheet1["O"+i])==null?void 0:Q.w)),(W=a.Sheets.Sheet1["P"+i])!=null&&W.w&&(f[i-2].busy=((q=a.Sheets.Sheet1["P"+i])==null?void 0:q.w)==u("On")),(X=a.Sheets.Sheet1["Q"+i])!=null&&X.w&&(f[i-2].pttid=(Y=a.Sheets.Sheet1["Q"+i])==null?void 0:Y.w),(N=a.Sheets.Sheet1["R"+i])!=null&&N.w&&(f[i-2].mode=Object.keys(s.modeOption).find(r=>{var T;return s.modeOption[r]==((T=a.Sheets.Sheet1["R"+i])==null?void 0:T.w)})),(Z=a.Sheets.Sheet1["S"+i])!=null&&Z.w&&(f[i-2].dtmf=((k=a.Sheets.Sheet1["S"+i])==null?void 0:k.w)==u("On")),(ee=a.Sheets.Sheet1["T"+i])!=null&&ee.w&&(((D=a.Sheets.Sheet1["T"+i])==null?void 0:D.w.split(",").indexOf("I"))>=0&&f[i-2].scanlist.push("I"),((d=a.Sheets.Sheet1["T"+i])==null?void 0:d.w.split(",").indexOf("II"))>=0&&f[i-2].scanlist.push("II"));t.renderData=f},o.readAsArrayBuffer(n)},e.click()};return(e,n)=>{const o=qe,x=Be,f=Re,v=Ae,a=Ne,g=Ue,S=ze,l=Me,c=je,p=Ve,C=Xe,I=Ye,_=Ze,E=ke,R=et,F=Ke;return le(),st("div",ft,[A.value>0?(le(),he(o,{key:0,theme:"loading",class:"midMessage"},{default:w(()=>[K("\u6B63\u5728\u6267\u884C\u4E2D("+B(A.value)+"%)",1)]),_:1})):me("",!0),m(x,{visible:te.showNotice,"onUpdate:visible":n[0]||(n[0]=h=>te.showNotice=h),onOk:be,onCancel:n[1]||(n[1]=h=>te.showNotice=!1)},{title:w(()=>[K(B(e.$t("menu.cps.writeNoticeTitle")),1)]),default:w(()=>[re("div",null,B(e.$t("menu.cps.writeNoticeContent")),1)]),_:1},8,["visible"]),m(f,{items:[e.$t("menu.dashboard"),e.$t("menu.cps.channel")]},null,8,["items"]),m(F,{class:"general-card"},{title:w(()=>[re("span",{onClick:n[2]||(n[2]=()=>{te.showHide+=1})},B(e.$t("menu.cps.channel")+e.$t("global.onStart")),1)]),default:w(()=>[m(p,{style:{"margin-bottom":"16px"}},{default:w(()=>[m(S,{span:12},{default:w(()=>[m(g,null,{default:w(()=>[m(a,{type:"primary",onClick:Ce},{icon:w(()=>[m(v)]),default:w(()=>[K(" "+B(e.$t("cps.onDeviceRead")),1)]),_:1}),m(a,{onClick:n[3]||(n[3]=h=>te.showNotice=!0)},{icon:w(()=>[m(v)]),default:w(()=>[K(" "+B(e.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1}),m(S,{span:12,style:{"text-align":"right"}},{default:w(()=>[m(g,null,{default:w(()=>[te.showHide>=5?(le(),he(c,{key:0},{content:w(()=>[m(a,{style:{width:"200px",margin:"10px","margin-bottom":"0px"},type:"primary",onClick:ve},{default:w(()=>[K(" \u4FDD\u5B58 ")]),_:1}),St,m(a,{style:{width:"200px",margin:"10px"},onClick:Ie},{default:w(()=>[K(" \u52A0\u8F7D ")]),_:1})]),default:w(()=>[m(a,null,{default:w(()=>[K(" \u4FDD\u5B58/\u52A0\u8F7D\uFF08\u5DF2\u5E9F\u5F03\uFF09"),m(l)]),_:1})]),_:1})):me("",!0),m(a,{type:"text",onClick:_e},{default:w(()=>[K(B(e.$t("cps.downloadImportTemplate")),1)]),_:1}),m(a,{type:"primary",onClick:Ee},{default:w(()=>[K(B(e.$t("cps.import")),1)]),_:1}),m(a,{onClick:Te},{default:w(()=>[K(B(e.$t("cps.export")),1)]),_:1})]),_:1})]),_:1})]),_:1}),m(R,{class:"ttable",loading:De(xe),size:"medium",columns:ge.value,data:t.renderData,pagination:{defaultPageSize:t.pageSize,total:t.renderData.length,defaultCurrent:1,pageSizeOptions:[15,30,50,100,200]},onChange:n[4]||(n[4]=h=>{t.pageSize=h.pagination.pageSize,t.nowPage=h.pagination.current}),bordered:"","lazy-load":"",headerAffixedTop:{offsetTop:60},hover:!0,"drag-sort":"row-handler",onDragSort:Oe},{drag:w(({row:h,rowIndex:b})=>[re("span",null,[m(De(tt))])]),index:w(({row:h,rowIndex:b})=>[K(B((t.nowPage-1)*t.pageSize+b+1),1)]),reverse:w(({row:h,rowIndex:b})=>[m(C,{modelValue:h.reverse,"onUpdate:modelValue":y=>h.reverse=y},null,8,["modelValue","onUpdate:modelValue"])]),busy:w(({row:h,rowIndex:b})=>[m(C,{modelValue:h.busy,"onUpdate:modelValue":y=>h.busy=y},null,8,["modelValue","onUpdate:modelValue"])]),dtmf:w(({row:h,rowIndex:b})=>[m(C,{modelValue:h.dtmf,"onUpdate:modelValue":y=>h.dtmf=y},null,8,["modelValue","onUpdate:modelValue"])]),scanlist:w(({row:h,rowIndex:b})=>[m(_,{modelValue:h.scanlist,"onUpdate:modelValue":y=>h.scanlist=y},{default:w(()=>[m(I,{key:"I",label:"I",value:"I"}),m(I,{key:"II",label:"II",value:"II"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),operate:w(({row:h,rowIndex:b})=>[m(E,{theme:"default",variant:"dashed",onClick:y=>ye((t.nowPage-1)*t.pageSize+b)},{default:w(()=>[K(B(e.$t("cps.clear")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","columns","data","pagination"])]),_:1})])}}});const qt=Pe(wt,[["__scopeId","data-v-9d30e610"]]);export{qt as default};
