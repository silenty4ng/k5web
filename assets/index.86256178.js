import{d as N,g as R,_ as W}from"./index.a1ade083.js";import{a1 as x,S as E,a2 as F,U as j,_ as q,d as G,k as H,W as J,a0 as M,a3 as O}from"./@arco-design.1f9a81c2.js";import"./vue.daf89c07.js";import{u as Q}from"./loading.bfb45974.js";import{e as v,a as V,f as g,s as A,b as P,g as X}from"./serial.0b46e76d.js";import{d as Y,h as Z,o as z,a as tt,x as a,u as r,z as I,A as k,_ as ot}from"./@vue.1cdd4af7.js";import"./vue-router.391082ef.js";import"./nprogress.b0a22fe3.js";import"./@intlify.d4358f23.js";import"./mitt.550594b0.js";import"./pinia.722f5e0f.js";import"./vue-demi.0f54e832.js";import"./axios.f3f20840.js";import"./vue-i18n.645f4f0b.js";import"./tdesign-vue-next.876353e4.js";import"./lodash-es.18922ecc.js";import"./tdesign-icons-vue-next.5ef165be.js";import"./sortablejs.b2e3c7c4.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";import"./dayjs.f7934723.js";import"./@vueuse.3623d212.js";import"./aegis-web-sdk.846094f8.js";import"./@zxing.8654f0db.js";import"./vue-matomo.4c7efa96.js";import"./b-tween.8dd4e2fe.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";const et={class:"container"},at={name:"Settings"},nt=Y({...at,setup(lt){const t=N(),{loading:B,setLoading:S}=Q(!1),o=Z({logo_line1:"",logo_line2:"",mdc_audio_local:!0,dtmfid:"",dtmf_up_code:"",dtmf_down_code:""});function T(e,l){if(e.length>l)return!1;for(let c=0;c<e.length;c++){let n=e.charAt(c);if((n<"0"||n>"9")&&(n<"A"||n>"D")&&n!="*"&&n!="#")return!1}return!0}const C=async(e,l,c)=>{var m;e=e.trim();let n;if(e==""){let u=[];for(let _=0;_<c;_++)u.push(0);n=new Uint8Array(u)}else if(T(e,c)){if(n=A(e),n.length<c){let u=new Uint8Array(c);u.set(n),n=u}}else return;await P(t.connectPort,l,n,n.length,(m=t.configuration)==null?void 0:m.uart)},K=async()=>{var n,m,u,_,w,f,d,y,b,h,i,U,s,$,D;if(t.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if(await v(t.connectPort),S(!0),((n=t.configuration)==null?void 0:n.charset)=="losehu"){let p=new Uint8Array(38);p.set(await V(t.connectPort,123680,38,(m=t.configuration)==null?void 0:m.uart),0),o.logo_line1=g(p.subarray(0,19),(u=t.configuration)==null?void 0:u.charset),o.logo_line2=g(p.subarray(19,38),(_=t.configuration)==null?void 0:_.charset)}else if(((w=t.configuration)==null?void 0:w.charset)=="gb2312"){let p=new Uint8Array(36);p.set(await V(t.connectPort,8192,36,(f=t.configuration)==null?void 0:f.uart),0),o.logo_line1=g(p.subarray(0,18),(d=t.configuration)==null?void 0:d.charset),o.logo_line2=g(p.subarray(18,36),(y=t.configuration)==null?void 0:y.charset)}else{let p=new Uint8Array(32);p.set(await V(t.connectPort,3760,32,(b=t.configuration)==null?void 0:b.uart),0),o.logo_line1=g(p.subarray(0,16),(h=t.configuration)==null?void 0:h.charset),o.logo_line2=g(p.subarray(16,32),(i=t.configuration)==null?void 0:i.charset)}const e=await V(t.connectPort,3808,8,(U=t.configuration)==null?void 0:U.uart);o.dtmfid=g(e);const l=await V(t.connectPort,3832,16,(s=t.configuration)==null?void 0:s.uart);o.dtmf_up_code=g(l);const c=await V(t.connectPort,3848,16,($=t.configuration)==null?void 0:$.uart);o.dtmf_down_code=g(c),parseInt(await V(t.connectPort,8189,1,(D=t.configuration)==null?void 0:D.uart))==0?o.mdc_audio_local=!1:o.mdc_audio_local=!0,S(!1)},L=async()=>{var e,l,c,n,m,u,_,w,f,d,y,b,h,i,U;if(t.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if(S(!0),await v(t.connectPort),((e=t.configuration)==null?void 0:e.charset)=="losehu"){let s=new Uint8Array(38);s.set(A(o.logo_line1,(l=t.configuration)==null?void 0:l.charset).subarray(0,19),0),s.set(A(o.logo_line2,(c=t.configuration)==null?void 0:c.charset).subarray(0,19),19),await P(t.connectPort,123678,[18,18],2,(n=t.configuration)==null?void 0:n.uart),await P(t.connectPort,123680,s,38,(m=t.configuration)==null?void 0:m.uart)}else if(((u=t.configuration)==null?void 0:u.charset)=="gb2312"){let s=new Uint8Array(36);s.set(A(o.logo_line1,(_=t.configuration)==null?void 0:_.charset).subarray(0,18),0),s.set(A(o.logo_line2,(w=t.configuration)==null?void 0:w.charset).subarray(0,18),18),await P(t.connectPort,8228,[18,18],2,(f=t.configuration)==null?void 0:f.uart),await P(t.connectPort,8192,s,36,(d=t.configuration)==null?void 0:d.uart)}else{let s=new Uint8Array(32);s.set(A(o.logo_line1,(y=t.configuration)==null?void 0:y.charset).subarray(0,16),0),s.set(A(o.logo_line2,(b=t.configuration)==null?void 0:b.charset).subarray(0,16),16),await P(t.connectPort,3760,s,32,(h=t.configuration)==null?void 0:h.uart)}await C(o.dtmfid,3808,8),await C(o.dtmf_up_code,3832,16),await C(o.dtmf_down_code,3848,16),(i=t.configuration)!=null&&i.localmdc&&await P(t.connectPort,8189,new Uint8Array([o.mdc_audio_local?1:0]),1,(U=t.configuration)==null?void 0:U.uart),await X(t.connectPort),S(!1)};return(e,l)=>{const c=R,n=q,m=G,u=H,_=J,w=M,f=x,d=O,y=E,b=F,h=j;return z(),tt("div",et,[a(c,{items:[e.$t("menu.dashboard"),e.$t("menu.cps.settings")]},null,8,["items"]),a(w,{gutter:20,align:"stretch"},{default:r(()=>[a(_,{span:24},{default:r(()=>[a(h,{class:"general-card",title:e.$t("menu.cps.settings")+e.$t("global.onStart")},{default:r(()=>[a(w,{style:{"margin-bottom":"16px"}},{default:r(()=>[a(_,{span:12},{default:r(()=>[a(u,null,{default:r(()=>[a(m,{type:"primary",onClick:K},{icon:r(()=>[a(n)]),default:r(()=>[I(" "+k(e.$t("cps.onDeviceRead")),1)]),_:1}),a(m,{onClick:L},{icon:r(()=>[a(n)]),default:r(()=>[I(" "+k(e.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(b,{loading:ot(B),style:{width:"100%"}},{default:r(()=>[a(d,{"label-col-style":{width:"25%"},field:"logo_line1",label:e.$t("cps.line1")},{default:r(()=>[a(f,{modelValue:o.logo_line1,"onUpdate:modelValue":l[0]||(l[0]=i=>o.logo_line1=i)},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{"label-col-style":{width:"25%"},field:"logo_line2",label:e.$t("cps.line2")},{default:r(()=>[a(f,{modelValue:o.logo_line2,"onUpdate:modelValue":l[1]||(l[1]=i=>o.logo_line2=i)},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{"label-col-style":{width:"25%"},field:"dtmfid",label:e.$t("cps.dtmfid")},{default:r(()=>[a(f,{modelValue:o.dtmfid,"onUpdate:modelValue":l[2]||(l[2]=i=>o.dtmfid=i),"max-length":"8",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{"label-col-style":{width:"25%"},field:"dtmf_up_code",label:e.$t("cps.dtmf.up")},{default:r(()=>[a(f,{modelValue:o.dtmf_up_code,"onUpdate:modelValue":l[3]||(l[3]=i=>o.dtmf_up_code=i),"max-length":"16",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{"label-col-style":{width:"25%"},field:"dtmf_down_code",label:e.$t("cps.dtmf.down")},{default:r(()=>[a(f,{modelValue:o.dtmf_down_code,"onUpdate:modelValue":l[4]||(l[4]=i=>o.dtmf_down_code=i),"max-length":"16",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{"label-col-style":{width:"25%"},field:"mdclocplay",label:e.$t("cps.mdclocplay")},{default:r(()=>[a(y,{modelValue:o.mdc_audio_local,"onUpdate:modelValue":l[5]||(l[5]=i=>o.mdc_audio_local=i),type:"round"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["loading"])]),_:1},8,["title"])]),_:1})]),_:1})])}}});const Rt=W(nt,[["__scopeId","data-v-8f91c5c7"]]);export{Rt as default};
