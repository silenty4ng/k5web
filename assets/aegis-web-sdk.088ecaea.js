import{c as Bn}from"./@intlify.b8ed1d74.js";var cn={exports:{}};(function(un,Wn){(function(be,Ee){un.exports=Ee()})(Bn,function(){var be,Ee;function Re(e){this.name="__st"+(1e9*Math.random()>>>0)+be+"__",e!=null&&e.forEach(this.add,this),be+=1}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,value:function(e){if(this===null)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o+=1}}}),window.WeakSet||(be=Date.now()%1e9,Re.prototype.add=function(e){var t=this.name;return e[t]||Object.defineProperty(e,t,{value:!0,writable:!0}),this},Re.prototype.delete=function(e){return!!e[this.name]&&!(e[this.name]=void 0)},Re.prototype.has=function(e){return!!e[this.name]},Ee=Re,Object.defineProperty(window,"WeakSet",{value:function(e){return new Ee(e)}})),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(e==null)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++)if((r=arguments[n])!=null)for(var r=Object(r),o=Object.keys(Object(r)),i=0,a=o.length;i<a;i++){var s=o[i],c=Object.getOwnPropertyDescriptor(r,s);c!=null&&c.enumerable&&(t[s]=r[s])}return t}});var st=function(e,t){return(st=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,r){n.__proto__=r}:function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}))(e,t)},P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function de(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var ne,ln=/_?t(\d)?(imestamp)?=\d+&?/g,ct=["aegis.qq.com","tamaegis.com","/aegis-sdk","rumt-","/flog.core.min.js","pingfore.qq.com","pingfore.tencent.com","zhiyan.tencent-cloud.net","h.trace.qq.com","btrace.qq.com","beacon.qq.com","dmplog.qq.com","qq.com/report","svibeacon.onezapp.com","cube.weixinbridge.com","doubleclick.net","pcmgrmonitor.3g.qq.com","tdm.qq.com","report.qqweb.qq.com","tpstelemetry.tencent.com","insight.cloud.tencent.com","facebook.com","facebook.net","google","yahoo.com","twitter.com","ga-audiences","report.idqqimg.com","arms-retcode.aliyuncs.com","px.effirst.com","sentry","baidu.com","hot-update.json","u.c.b.r.o.w.s.e.r","report.url.cn","sockjs-node","m3u8"],fn=["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Failed to execute 'transaction'","window.indexedDB.deleteDatabase is not a function"],ut=["ext1","ext2","ext3","level","trace","tag","seq","code"],dn=["static","fetch"],U="unknown",pn=(re.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},re.prototype.on=function(e,t,n){var r;if(n===void 0&&(n=0),this)return(r=this.eventsList[e])||(this.eventsList[e]=[],r=this.eventsList[e]),this.indexOf(r,t)===-1&&r.push({name:e,type:n||0,callback:t}),this},re.prototype.one=function(e,t){this.on(e,t,1)},re.prototype.remove=function(e,t){if(this){var n=this.eventsList[e];if(n){if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.eventsList[e]}catch{}}return null}},re.prototype.clear=function(){this.eventsList={}},re),hn=function(e){if(!e||e.length===0)return"{}";e=Array.isArray(e)?e:[e];var t=Object.keys(e[0]),n={};return t.forEach(function(r){n[r]=e.map(function(o){return o[r]})}),n.count=e.length,ht(n)};function re(){var e=this;this.emit=function(t,n){if(e){var r;if((o=e.eventsList[t])!=null&&o.length)for(var o=o.slice(),i=0;i<o.length;i++){r=o[i];try{var a=r.callback.apply(e,[n]);if(r.type===1&&e.remove(t,r.callback),a===!1)break}catch(s){throw s}}return e}},this.eventsList={}}(h=ne=ne||{})[h.number=-1]="number",h.string="";function Te(e,t){return typeof e=="number"||typeof e=="string"?e:t?ne.string:ne.number}function oe(e,t){return typeof e=="string"?e.split("?")[t?1:0]||"":e}function lt(e,t){return t===void 0&&(t=2048),String(e).replace(ln,"").slice(0,t)}function Oe(e){return typeof e=="string"&&/^\//.test(e)?(location==null?void 0:location.protocol)==="https:":/^https/.test(e)}function ft(e,t,n){var r,o,i,a;try{if(typeof(t==null?void 0:t.retCodeHandler)=="function")return i=(o=t.retCodeHandler(e,n==null?void 0:n.url,n==null?void 0:n.ctx,n==null?void 0:n.payload)||{}).code,a=o.isErr,{code:i===void 0?U:i,isErr:a};if(!(e=typeof e=="string"?JSON.parse(e):e))return{code:U,isErr:!1};typeof((r=t==null?void 0:t.ret)==null?void 0:r.join)=="function"&&(xe=[].concat(t.ret.map(function(c){return c.toLowerCase()})));var s=Object.getOwnPropertyNames(e).filter(function(c){return xe.indexOf(c.toLowerCase())!==-1});return s.length?{code:""+(i=(i=e[s[0]])!=="\u672A\u77E5"&&i!==""?i:U),isErr:i!==0&&i!=="0"&&i!==U}:{code:U,isErr:!1}}catch{return{code:U,isErr:!1}}}function pe(e,t,n){try{var r=typeof t=="function"?t(e,n==null?void 0:n.url)||"":e;return Ge(r).slice(0,102400)}catch{return""}}function ie(e,t){return typeof e!="string"||!e||t&&-1<e.indexOf(t)||En.test(e)||ct.some(function(n){return-1<e.indexOf(n)})}function Se(e,t){var n,r=[],o=e.config;return e.lifeCycle.on("destroy",function(){r.length=0}),function(i,a){Array.isArray(i)?r=r.concat(i):r.push(i),t&&r.length>=t||e.sendNow&&0<r.length?(r=gt(r),a(r.splice(0,r.length)),n&&clearTimeout(n)):(n&&clearTimeout(n),n=setTimeout(function(){n=null,0<(r=gt(r)).length&&a(r.splice(0,r.length))},o.delay))}}function gn(e,t){return Array.isArray(e)?t(e.map(function(n){return r=P(P({},n),{msg:typeof n.msg=="string"?n.msg:[].concat(n.msg).map(J).join(" ")}),ut.forEach(function(o){r[o]||delete r[o]}),r;var r})):t([P(P({},e),{msg:typeof e.msg=="string"?e.msg:J(e.msg)})])}function mn(e,t){return function(n,r){var o,i,a,s=Array.isArray(n),c=s?n:[n],u=(e.lifeCycle.emit("beforeRequest",n),e.config.beforeRequest);(c=typeof u=="function"?c.map(function(l){try{var f=u({logs:l,logType:t});return(f==null?void 0:f.logType)===t&&f!=null&&f.logs?f.logs:f!==!1&&l}catch{return l}}).filter(function(l){return l!==!1}):c).length&&(o=c,n=ut,!Array.isArray(o)||o.length<=1||(i=[],a=[],!(a=typeof n=="string"?[n]:n))||a.length<=0||(a.forEach(function(l){o.forEach(function(f){f!=null&&f[l]&&i.push(l)})}),0<i.length&&(o=o.map(function(l){var f={};return i.forEach(function(d){f[d]=""}),P(P({},f),l)}))),c=o,r(s?c:c[0]))}}function dt(e){return function(t,n){e.lifeCycle.emit("modifyRequest",t);var r=e.config.modifyRequest;if(typeof r=="function")try{var o=r(t);typeof o=="object"&&"url"in o&&(t=o)}catch(i){console.error(i)}n(t)}}function pt(e){return function(t,n){(r=e.lifeCycle)!=null&&r.emit("afterRequest",t);var r=(e.config||{}).afterRequest;typeof r=="function"&&r(t)===!1||n(t)}}var S,L,_,vn=["application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/x-javascript","application/ecmascript","application/vnd.mspowerpoint","application/vnd.apple.mpegurl","application/ogg","text/css","text/javascript","image","audio","video","video/mp2t"],yn=/\.(json|js|css|jpg|jpeg|png|svg|apng|webp|gif|bmp|mp4|mp3|ts|mpeg|wav|webm|ogg|flv|m3u8|ttf|woff2|otf|eot|woff|html|htm|shtml|shtm|)$/i,xe=["ret","retcode","code","errcode"],We=function(){var e=new WeakSet;return function(t,n){if(n instanceof Error)return"Error.message: "+n.message+` 
  Error.stack: `+n.stack;if(typeof n=="object"&&n!==null){if(e.has(n))return"[Circular "+(t||"root")+"]";e.add(n)}return n}},J=function(e){if(typeof e=="string")return e;try{return e instanceof Error?(JSON.stringify(e,We(),4)||"undefined").replace(/"/gim,""):JSON.stringify(e,We(),4)||"undefined"}catch(t){return`error happen when aegis stringify: 
 `+t.message+` 
 `+t.stack}},ht=function(e){if(typeof e=="string")return e;try{return JSON.stringify(e,We())||"undefined"}catch(t){return`error happen when aegis stringify: 
 `+t.message+` 
 `+t.stack}},Ge=function(e,t){t===void 0&&(t=3);var n,r,o,i="";return Array.isArray(e)?(i+="[",n=e.length,e.forEach(function(a,s){i=(i+=typeof a=="object"&&1<t?Ge(a,t-1):bn(a))+(s===n-1?"":",")}),i+="]"):e instanceof Object?(i="{",r=Object.keys(e),o=r.length,r.forEach(function(a,s){typeof e[a]=="object"&&1<t?i+='"'+a+'":'+Ge(e[a],t-1):i+=wn(a,e[a]),i+=s===o-1||s<o-1&&e[r[s+1]]===void 0?"":","}),i+="}"):i+=e,i},wn=function(e,t){var n=typeof t,r="";return n=="string"||n=="object"?r+='"'+e+'":"'+t+'"':typeof t=="function"?r+='"'+e+'":"function '+t.name+'"':typeof t=="symbol"?r+='"'+e+'":"symbol"':typeof t!="number"&&n!="boolean"||(r+='"'+e+'": '+t),r},bn=function(e){var t=typeof e;return""+(t=="undefined"||t=="symbol"||t=="function"?"null":t=="string"||t=="object"?'"'+e+'"':e)},En=/data:(image|text|application|font)\/.*;base64/,gt=((h=S=S||{}).INFO_ALL="-1",h.API_RESPONSE="1",h.INFO="2",h.ERROR="4",h.PROMISE_ERROR="8",h.AJAX_ERROR="16",h.SCRIPT_ERROR="32",h.IMAGE_ERROR="64",h.CSS_ERROR="128",h.CONSOLE_ERROR="256",h.MEDIA_ERROR="512",h.RET_ERROR="1024",h.REPORT="2048",h.PV="4096",h.EVENT="8192",h.PAGE_NOT_FOUND_ERROR="16384",h.WEBSOCKET_ERROR="32768",h.BRIDGE_ERROR="65536",h.LAZY_LOAD_ERROR="131072",(h=L=L||{}).LOG="log",h.SPEED="speed",h.PERFORMANCE="performance",h.OFFLINE="offline",h.WHITE_LIST="whiteList",h.VITALS="vitals",h.PV="pv",h.CUSTOM_PV="customPV",h.EVENT="event",h.CUSTOM="custom",h.SDK_ERROR="sdkError",h.SET_DATA="setData",h.LOAD_PACKAGE="loadPackage",(h=_=_||{}).production="production",h.development="development",h.gray="gray",h.pre="pre",h.daily="daily",h.local="local",h.test="test",h.others="others",function(e){return e.filter(function(t,n){return t.type!=="static"||!e.find(function(r,o){return t.url===r.url&&t.status===200&&n<o})})}),mt=function(e){e.level===S.INFO_ALL&&(e.level=S.INFO)},te={},ae={},Xe=function(e){return te[e]||(te[e]=setTimeout(function(){ae[e]={},te[e]=null},6e4)),te[e]},Rn=function(e){return(Array.isArray(e)?e:[e]).map(function(t){return Object.getOwnPropertyNames(t).reduce(function(n,r){return r!=="ctx"&&(n[r]=t[r]),n},{level:S.INFO,msg:""})})},vt=function(e){return function(t){return e.sendPipeline([function(n,r){return r({url:e.config.url||"",data:hn(Rn(n)),method:"post",contentType:"application/json",type:L.LOG,log:n,requestConfig:{timeout:5e3},success:function(){var o=e.config.onReport;typeof o=="function"&&n.forEach(function(i){o(i)}),typeof r=="function"&&r([])}})}],L.LOG)(t)}},Pe={generateTraceId:yt(16),generateSpanId:yt(8)},Le=Array(32);function yt(e){return function(){for(var t=0;t<2*e;t++)Le[t]=Math.floor(16*Math.random())+48,58<=Le[t]&&(Le[t]+=39);return String.fromCharCode.apply(null,Le.slice(0,2*e))}}function wt(){return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,function(e){return(e^(16*Math.random()&15)>>e/4).toString(16)})}function Ve(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return(e==="x"?t:3&t|8).toString(16)})}function Tn(e){for(var t,n,r,o="",i=0,a=(e=String(e)).length%3;i<e.length;){if(255<(t=e.charCodeAt(i++))||255<(n=e.charCodeAt(i++))||255<(r=e.charCodeAt(i++)))throw new TypeError("Failed to execute 'btoa': The string to be encoded contains characters outside of the Latin1 range.");o+=K.charAt((t=t<<16|n<<8|r)>>18&63)+K.charAt(t>>12&63)+K.charAt(t>>6&63)+K.charAt(63&t)}return a?o.slice(0,a-3)+"===".substring(a):o}function On(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!Sn.test(e))throw new TypeError("Failed to execute 'atob': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var n,r,o="",i=0;i<e.length;)t=K.indexOf(e.charAt(i++))<<18|K.indexOf(e.charAt(i++))<<12|(n=K.indexOf(e.charAt(i++)))<<6|(r=K.indexOf(e.charAt(i++))),o+=n===64?String.fromCharCode(t>>16&255):r===64?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}function $e(e){var t,n="";return n=typeof e=="object"&&(t=(e=function(r,o){for(var i=0;i<o.length;i++){var a=o[i],s=r[a]||typeof r.get=="function"&&r.get(a);if(s)return[a,s]}return["",""]}(e,Object.keys(bt)))[0],e=e[1],t)?bt[t](e):n}function se(e){if(e&&e.reduce&&e.length)return e.length===1?function(t,n){e[0](t,n||Et)}:e.reduce(function(t,n){return function(r,o){return o===void 0&&(o=Et),t(r,function(i){return n==null?void 0:n(i,o)})}});throw new TypeError("createPipeline need at least one function param")}function Je(e,t){Object.getOwnPropertyNames(e).forEach(function(n){typeof e[n]=="function"&&n!=="constructor"&&(t?t[n]=n==="sendPipeline"?function(){return function(){}}:function(){}:e[n]=function(){})})}function ke(){return window.performance!==void 0&&typeof performance.getEntriesByType=="function"&&typeof performance.now=="function"}function k(e){return kn.indexOf(e)!==-1}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Sn=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,xn=(V.prototype.generate=function(e,t,n){if(t===void 0&&(t={}),this.url=e,!this.isUrlIgnored()&&this.isUrlInTraceUrls()&&this.traceType){switch(this.traceType){case"traceparent":this.traceId=this.createTraceparent();break;case"b3":this.traceId=this.createB3();break;case"sw8":this.traceId=this.createSw8(n);break;case"sentry-trace":this.traceId=this.createSentryTrace();break;default:return console.warn("this trace key "+this.traceType+" is not supported"),void(this.traceId="")}return t[this.traceType]&&(this.traceId=t[this.traceType]),{name:this.traceType,value:this.traceId}}},V.prototype.createTraceparent=function(){var e=Pe.generateSpanId();return"00-"+Pe.generateTraceId()+"-"+e+"-0"+this.traceFlag.toString(16)},V.prototype.createB3=function(){var e=Pe.generateSpanId();return Pe.generateTraceId()+"-"+e+"-"+this.traceFlag},V.prototype.createSw8=function(r){var t=typeof btoa=="function"?btoa:Tn,r=r||{},n=r.host,n=n===void 0?"":n,r=r.pathname,r=r===void 0?"":r,o=Ve(),i=Ve();return"1-"+String(t(i))+"-"+String(t(o))+"-1-"+String(t("aegis"))+"-"+String(t("1.39.2"))+"-"+String(t(encodeURI(r)))+"-"+String(t(n))},V.prototype.createSentryTrace=function(){var e=wt().substring(16);return wt()+"-"+e+"-"+this.traceFlag},V.prototype.isUrlIgnored=function(){if(Array.isArray(this.ignoreUrls)&&this.ignoreUrls.length!==0)for(var e=0,t=this.ignoreUrls;e<t.length;e++){var n=t[e];if(this.urlMatches(this.url,n))return!0}return!1},V.prototype.isUrlInTraceUrls=function(){if(!this.urls)return!0;if(Array.isArray(this.urls)){if(this.urls.length===0)return!1;for(var e=0,t=this.urls;e<t.length;e++){var n=t[e];if(this.urlMatches(this.url,n))return!0}}return!1},V.prototype.urlMatches=function(e,t){return typeof t=="string"?e===t:!!e.match(t)},V),bt={sw8:function(n){var t=typeof atob=="function"?atob:On,n=n.split("-")[1];return n?t(n):""},traceparent:function(e){return e.split("-")[1]},b3:function(e){return e.split("-")[0]},"sentry-trace":function(e){return e.split("-")[0]}},Et=function(){},h=(E.use=function(e){E.installedPlugins.indexOf(e)===-1&&e.aegisPlugin&&E.installedPlugins.push(e)},E.unuse=function(e){e=E.installedPlugins.indexOf(e),e!==-1&&E.installedPlugins.splice(e,1)},E.prototype.init=function(e){this.setConfig(e);for(var t=0;t<E.installedPlugins.length;t++)try{E.installedPlugins[t].patch(this)}catch(n){this.sendSDKError(n)}this.lifeCycle.emit("onInited")},E.prototype.destroy=function(e){e===void 0&&(e=!1);var t,n,r=E.instances.indexOf(this);r!==-1&&E.instances.splice(r,1);for(var o=E.installedPlugins.length-1;0<=o;o--)try{E.installedPlugins[o].unpatch(this)}catch(a){this.sendSDKError(a)}if(this.lifeCycle.emit("destroy"),this.lifeCycle.clear(),e)t=this,n=Object.getOwnPropertyDescriptors(t),Object.keys(n).forEach(function(a){n[a].writable&&(t[a]=null)}),Object.setPrototypeOf(this,null);else{for(var i=this;i.constructor!==Object&&Je(i,this),i=Object.getPrototypeOf(i););E.instances.length===0&&(r=Object.getPrototypeOf(this).constructor,Je(r),Je(E))}},E.prototype.setConfig=function(l){Object.assign(this.config,l);var l=this.config,t=l.id,n=l.uin,r=l.version,o=l.ext1,i=l.ext2,a=l.ext3,s=l.aid,u=l.env,c=u===void 0?"production":u,u=l.pageUrl,l=this.bean.id!==t||this.bean.uin!==n||this.bean.aid!==s;return this.bean.id=t||"",this.bean.uin=n||"",this.bean.version=r||"1.39.2",this.bean.aid=s||"",this.bean.env=function(){switch(c){case _.production:case _.development:case _.gray:case _.pre:case _.daily:case _.local:case _.test:case _.others:return 1;default:return}}()?c:_.others,u&&this.extendBean("from",encodeURIComponent(u.slice(0,2048))),o&&this.extendBean("ext1",encodeURIComponent(o)),i&&this.extendBean("ext2",encodeURIComponent(i)),a&&this.extendBean("ext3",encodeURIComponent(a)),l&&this.lifeCycle.emit("onConfigChange",this.config),this.config},E.prototype.extendBean=function(e,t){this.bean[e]=t},E.prototype.send=function(e,t,n){var r=this;return se([dt(this),function(o,i){r.request(o,function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];i({isErr:!1,result:a,logType:o.type,logs:o.log}),t!=null&&t.apply(void 0,a)},function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];i({isErr:!0,result:a,logType:o.type,logs:o.log}),n!=null&&n.apply(void 0,a)})},pt(this)])(e)},E.prototype.sendSDKError=function(e){var t=this;this.sendPipeline([function(n,r){r({url:t.config.url+"?id=1085&msg[0]="+encodeURIComponent(J(n))+"&level[0]=2&from="+t.config.id+"&count=1&version="+t.config.id+"(1.39.2)",addBean:!1,method:"get",type:L.SDK_ERROR,log:n})}],L.SDK_ERROR)(e)},E.prototype.sendPipeline=function(e,t){var n,r=this;return se(de([function(o,i){if(typeof n.config.random!="number"&&(console.warn("random must in [0, 1], default is 1."),n.config.random=1),!n.isHidden||!n.isGetSample)if(n.isGetSample)n.isHidden||i(o);else{if(n.isGetSample=!0,Math.random()<n.config.random)return n.isHidden=!1,i(o);n.isHidden=!0}},mn(n=this,t)],e,[dt(this),function(o,i){r.request(o,function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c=!1;-1<(""+a[r.failRequestCount=0]).indexOf("403 forbidden")&&(c=!0,r.destroy()),i({isErr:c,result:a,logType:o==null?void 0:o.type,logs:o==null?void 0:o.log}),(c=o==null?void 0:o.success)!=null&&c.call.apply(c,de([o],a))},function(){for(var a,s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];60<=++r.failRequestCount&&r.destroy(),-1<(""+s[0]).indexOf("403 forbidden")&&r.destroy(),i({isErr:!0,result:s,logType:o==null?void 0:o.type,logs:o==null?void 0:o.log}),(a=o==null?void 0:o.fail)!=null&&a.call.apply(a,de([o],s))})},pt(this)]))},E.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:S.INFO,msg:e};e.length===1&&e[0].msg&&Object.assign(n,P({},e[0]),{level:S.INFO}),this.normalLogPipeline(n)},E.prototype.infoAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:S.INFO_ALL,msg:e};e.length===1&&e[0].msg&&Object.assign(n,P({},e[0]),{level:S.INFO_ALL}),this.normalLogPipeline(n)},E.prototype.report=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:S.REPORT,msg:e};e.length===1&&e[0].msg&&Object.assign(n,P({},e[0])),this.normalLogPipeline(n)},E.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:S.ERROR,msg:e};e.length===1&&e[0].msg&&Object.assign(n,P({},e[0]),{level:S.ERROR}),this.normalLogPipeline(n)},E.prototype.reportEvent=function(e){e&&((e=typeof e=="string"?{name:e,ext1:this.config.ext1||"",ext2:this.config.ext2||"",ext3:this.config.ext3||""}:e).name?(typeof e.name!="string"&&(console.warn("reportEvent params name must be string"),e.name=String(e.name)),this.eventPipeline(e)):console.warn("reportEvent params error"))},E.prototype.reportT=function(a){var t=a.name,n=a.duration,r=a.ext1,r=r===void 0?"":r,o=a.ext2,o=o===void 0?"":o,i=a.ext3,i=i===void 0?"":i,a=a.from;if(typeof t=="string"&&typeof n=="number"&&typeof r=="string"&&typeof o=="string"&&typeof i=="string"){if(!(n<0||6e4<n))return this.submitCustomTime(t,n,r,o,i,a===void 0?"":a);console.warn("reportTime: duration must between 0 and 60000")}else console.warn("reportTime: params error")},E.prototype.reportTime=function(e,t){if(typeof e=="object")return this.reportT(e);typeof e=="string"?typeof t=="number"?t<0||6e4<t?console.warn("reportTime: duration must between 0 and 60000"):this.submitCustomTime(e,t):console.warn("reportTime: second param must be number"):console.warn("reportTime: first param must be a string")},E.prototype.time=function(e){typeof e=="string"?this.timeMap[e]?console.warn("Timer "+e+" already exists"):this.timeMap[e]=Date.now():console.warn("time: first param must be a string")},E.prototype.timeEnd=function(e){typeof e=="string"?this.timeMap[e]?(this.submitCustomTime(e,Date.now()-this.timeMap[e]),delete this.timeMap[e]):console.warn("Timer "+e+" does not exist"):console.warn("timeEnd: first param must be a string")},E.prototype.ready=function(e,t,n){throw new Error('You need to override "ready" method')},E.prototype.request=function(e,t,n){throw new Error('You need to override "request" method')},E.prototype.speedLogPipeline=function(e){throw new Error('You need to override "speedLogPipeline" method')},Object.defineProperty(E.prototype,"__version__",{get:function(){return"1.39.2"},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"LogType",{get:function(){return S},enumerable:!1,configurable:!0}),E.prototype.reportPv=function(e){e&&console.warn("reportPv is deprecated, please use reportEvent")},E.prototype.submitCustomTime=function(e,t,n,r,o,i){this.customTimePipeline({name:e,duration:t,ext1:n||this.config.ext1,ext2:r||this.config.ext2,ext3:o||this.config.ext3,from:i||void 0})},E.version="1.39.2",E.instances=[],E.logType=S,E.environment=_,E.installedPlugins=[],E),A=(M.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.instances.push(e),this.triggerInit(e),this.triggerOnNewAegis(e))},M.prototype.unpatch=function(e){var t=this.instances.indexOf(e);t!==-1&&(this.instances.splice(t,1),this.instances.length===0)&&this.uninstall(e)},M.prototype.countInstance=function(){return this.instances.length},M.prototype.uninstall=function(e){var t;(t=(t=this.option)==null?void 0:t.destroy)!=null&&t.apply(this,[e])},M.prototype.walk=function(e){var t=this;this.instances.forEach(function(n){var r=t.canUse(n);r&&e(n,r)})},M.prototype.canUse=function(e){return e=this.getConfig(e),!(!e||typeof e!="object")||!!e},M.prototype.getConfig=function(e){return(e=e.config)==null?void 0:e[this.name]},M.prototype.exist=function(e){return this.instances.indexOf(e)===-1},M.prototype.triggerInit=function(e){var t;this.inited||(this.inited=!0,(t=(t=this.option)==null?void 0:t.init)==null)||t.call(this.option,this.getConfig(e))},M.prototype.triggerOnNewAegis=function(e){var t;(t=(t=this.option)==null?void 0:t.onNewAegis)!=null&&t.call(this.option,e,this.getConfig(e))},M),Pn=new A({name:"aid",aid:"",init:function(e){try{var t=e!==!0&&e||window.localStorage.getItem("AEGIS_ID");t||(t=Ve(),window.localStorage.setItem("AEGIS_ID",t)),this.aid=t}catch{}},onNewAegis:function(e){e.bean.aid=this.aid,e.config.aid=this.aid}}),Rt=function(e){var t;return e.payload?(t={},Object.keys(e).forEach(function(n){n!=="payload"&&(t[n]=e[n])}),t):e},Ce=new A({name:"reportAssetSpeed"}),Ln=Ce=new A({name:"reportAssetSpeed",collectCur:0,collectEntryType:"resource",ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video"],onNewAegis:function(e){var t=this;ke()&&(this.collectSuccessLog(e),this.collectFailLog(e),performance.onresourcetimingbufferfull=function(){typeof performance.clearResourceTimings=="function"&&(t.collectCur=0,performance.clearResourceTimings())})},publish:function(e,t){this.$walk(function(n){n===t&&n.speedLogPipeline(e)})},publishMany:function(e,t){for(var n=t.config,r=0,o=e.length;r<o;r++){var i=e[r];this.ASSETS_INITIATOR_TYPE.indexOf(i.initiatorType)===-1||ie(i.name,n.hostUrl)||this.publish(this.generateLog(i,n),t)}},collectSuccessLog:function(e){var t,n,r=this;typeof window.PerformanceObserver=="function"?(this.publishMany(performance.getEntriesByType(this.collectEntryType),e),(t=new window.PerformanceObserver(function(o){r.publishMany(o.getEntries(),e)})).observe({entryTypes:[this.collectEntryType]}),e.lifeCycle.on("destroy",function(){Ce.countInstance()===0&&t.disconnect()})):(n=setInterval(function(){var o=performance.getEntriesByType(r.collectEntryType),i=o.slice(r.collectCur);r.collectCur=o.length,r.publishMany(i,e)},3e3),e.lifeCycle.on("destroy",function(){Ce.countInstance()===0&&clearInterval(n)}))},collectFailLog:function(e){function t(o){var i,a;o&&(o=o.target||o.srcElement,!(i=(o==null?void 0:o.src)||(o==null?void 0:o.href))||typeof i!="string"||-1<window.location.href.indexOf(i)||(o=typeof((o=r.api)==null?void 0:o.resourceTypeHandler)=="function"?(o=r.api)==null?void 0:o.resourceTypeHandler(i):"",a=performance.getEntriesByType(n.collectEntryType).find(function(s){return s.name===i}),ie(i,r.hostUrl))||(a={url:lt(i),status:400,duration:Number(((a==null?void 0:a.duration)||0).toFixed(2)),method:"get",type:o||"static",isHttps:Oe(i),urlQuery:oe(i,!0),nextHopProtocol:"",domainLookup:0,connectTime:0},n.publish(a,e)))}var n=this,r=e.config;window.document.addEventListener("error",t,!0),e.lifeCycle.on("destroy",function(){Ce.countInstance()===0&&window.document.removeEventListener("error",t,!0)})},generateLog:function(e,n){var n=typeof((r=n.api)==null?void 0:r.resourceTypeHandler)=="function"?(r=n.api)==null?void 0:r.resourceTypeHandler(e.name):"",r=e.transferSize;return{url:lt(e.name),method:"get",duration:Number(e.duration.toFixed(2)),status:200,type:n||"static",isHttps:Oe(e.name),nextHopProtocol:e.nextHopProtocol||"",urlQuery:oe(e.name,!0),domainLookup:Te(e.domainLookupEnd-e.domainLookupStart),connectTime:Te(e.connectEnd-e.connectStart),transferSize:0<r?r:-1}},collectNotReportedLog:function(e){var t,n;ke()&&(t=(n=performance.getEntriesByType(this.collectEntryType)).length,typeof window.PerformanceObserver!="function")&&this.collectCur!==t&&(n=n.slice(this.collectCur),this.collectCur=t,this.publishMany(n,e,!0))},destroy:function(){this.option.publish=function(){}}}),kn=window.navigator.userAgent.toLowerCase(),g={};function M(e){this.aegisPlugin=!0,this.name="",this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}function E(e){var t,n,r,o,i,a,s,c,u,l,f,d,p,T,O=this;this.isGetSample=!1,this.isHidden=!1,this.config={version:0,delay:1e3,onError:!0,repeat:60,random:1,aid:!0,device:!0,pagePerformance:!0,webVitals:!0,speedSample:!0,onClose:!0,reportLoadPackageSpeed:!0,hostUrl:"https://aegis.qq.com",env:"production",url:"",offlineUrl:"",whiteListUrl:"",pvUrl:"",speedUrl:"",customTimeUrl:"",performanceUrl:"",performanceUrlForHippy:"",webVitalsUrl:"",eventUrl:"",setDataReportUrl:"",reportImmediately:!0},this.isWhiteList=!1,this.lifeCycle=new pn,this.bean={},this.normalLogPipeline=se([Se(this,5),gn,function(m,w){var v=t.config;w(m=m.map(function(y){var b,R=v.maxLength||102400;try{if(!y.msg||y.msg.length<=R)return y;y.msg=(b=y.msg)==null?void 0:b.substring(0,R)}catch{y.msg=J(y.msg).substring(0,v.maxLength)}return y}))},(T=(t=this).config,function(m,w){var v=typeof T.repeat=="number"?T.repeat:60;if(v<=0)return w(m);var y=(T==null?void 0:T.id)+"_error",b=ae[y]||{};w(m.filter(function(R){if(R.level===S.ERROR||R.level===S.PROMISE_ERROR||R.level===S.AJAX_ERROR||R.level===S.SCRIPT_ERROR||R.level===S.IMAGE_ERROR||R.level===S.CSS_ERROR||R.level===S.MEDIA_ERROR||R.level===S.RET_ERROR||R.level===S.BRIDGE_ERROR||R.level===S.PAGE_NOT_FOUND_ERROR||R.level===S.WEBSOCKET_ERROR||R.level===S.LAZY_LOAD_ERROR){if(R=R.msg.slice(0,200),b[R]>v)return te[y]||Xe(y),!1;b[R]=1+~~b[R],ae[y]=b}return!0}))}),(d=this.lifeCycle.emit,p=this.config,function(m,w){var v,y=p.logCreated;return typeof y=="function"?(v=m.filter(function(b){return y(b)!==!1}),d("beforeWrite",v),w(v)):(d("beforeWrite",m),w(m))}),(f=this,setTimeout(function(){var v=f.config,w=v.pvUrl,m=w===void 0?"":w,w=v.spa,v=-1<["web-sdk","mp-sdk"].indexOf("web-sdk");m&&(v&&!w||!v)&&f.sendPipeline([function(y,b){b({url:m,type:L.PV})}],L.PV)(null)},100),function(m,w){w(m)}),(u=c=s=!1,l=[],(i=this).lifeCycle.on("onConfigChange",function(){a&&clearTimeout(a),a=setTimeout(function(){var m,w;!u&&i.config&&(u=!0,m=i.config.whiteListUrl,(w=m===void 0?"":m)&&i.sendPipeline([function(v,y){y({url:w,type:L.WHITE_LIST,success:function(b){c=!0;try{var R=b.data||JSON.parse(b),G=R.retcode,I=R.result,N=I===void 0?{}:I,fe=(G===0&&(s=N.is_in_white_list,i.isWhiteList=s,0<=N.rate)&&N.rate<=1&&(i.config.random=N.rate,i.isGetSample=!1),i.isWhiteList&&l.length?vt(i)(l.splice(0),function(){}):!i.isWhiteList&&l.length&&(l.length=0),i.config.onWhitelist);typeof fe=="function"&&fe(s)}catch{}},fail:function(){c=!0}})}],L.WHITE_LIST)(null),u=!1)},i.config.uin?50:500)}),i.lifeCycle.on("destroy",function(){l.length=0}),function(m,w){var v;s||(v=(v=i.config)==null?void 0:v.api)!=null&&v.reportRequest?w(m.concat(l.splice(0)).map(function(y){return mt(y),y})):(v=m.filter(function(y){return y.level!==S.INFO&&y.level!==S.API_RESPONSE?(mt(y),!0):(c||(l.push(y),200<=l.length&&(l.length=200)),!1)})).length&&w(v)}),function(m,w){try{var v=JSON.parse(JSON.stringify(m)),y=(O.lifeCycle.emit("beforeReport",v),O.config.beforeReport);(m=typeof y=="function"?m.filter(function(b){return y(b)!==!1}):m).length&&w(m)}catch{}},vt(this)]),this.eventPipeline=se([Se(this,10),(o=this,function(m){o.sendPipeline([function(w,v){var y=w.map(function(b){return{name:b.name,ext1:b.ext1||o.config.ext1||"",ext2:b.ext2||o.config.ext2||"",ext3:b.ext3||o.config.ext3||""}});v({url:o.config.eventUrl+"?payload="+encodeURIComponent(JSON.stringify(y)),type:L.EVENT,log:w})}],L.EVENT)(m)})]),this.customTimePipeline=se([Se(this,10),(r=this,function(m){return r.sendPipeline([function(w,v){v({url:r.config.customTimeUrl+"?payload="+encodeURIComponent(JSON.stringify({custom:w})),type:L.CUSTOM,log:w})}],L.CUSTOM)(m)})]),this.timeMap={},this.failRequestCount=0,this.config=(n=this.config,(e=e.hostUrl)===void 0&&(e="https://aegis.qq.com"),n.url=n.url||e+"/collect",n.offlineUrl=n.offlineUrl||e+"/offline",n.whiteListUrl=n.whiteListUrl||e+"/collect/whitelist",n.pvUrl=n.pvUrl||e+"/collect/pv",n.eventUrl=n.eventUrl||e+"/collect/events",n.speedUrl=n.speedUrl||e+"/speed",n.customTimeUrl=n.customTimeUrl||e+"/speed/custom",n.performanceUrl=n.performanceUrl||e+"/speed/performance",n.performanceUrlForHippy=n.performanceUrlForHippy||e+"/speed/hippyPerformance",n.webVitalsUrl=n.webVitalsUrl||e+"/speed/webvitals",n.setDataReportUrl=n.SetDataReportUrl||e+"/speed/miniProgramData",n),E.instances.push(this)}function V(e,t,n,r){n===void 0&&(n=null),this.traceType=e,this.ignoreUrls=t,this.urls=n,this.traceFlag=r==null?1:Number(!!r)}g.macos=function(){return k("mac")},g.ios=function(){return g.iphone()||g.ipod()||g.ipad()},g.iphone=function(){return!g.windows()&&k("iphone")},g.ipod=function(){return k("ipod")},g.ipad=function(){var e=navigator.platform==="MacIntel"&&1<navigator.maxTouchPoints;return k("ipad")||e},g.android=function(){return!g.windows()&&k("android")},g.androidPhone=function(){return g.android()&&k("mobile")},g.androidTablet=function(){return g.android()&&!k("mobile")},g.blackberry=function(){return k("blackberry")||k("bb10")},g.blackberryPhone=function(){return g.blackberry()&&!k("tablet")},g.blackberryTablet=function(){return g.blackberry()&&k("tablet")},g.windows=function(){return k("windows")},g.windowsPhone=function(){return g.windows()&&k("phone")},g.windowsTablet=function(){return g.windows()&&k("touch")&&!g.windowsPhone()},g.fxos=function(){return(k("(mobile")||k("(tablet"))&&k(" rv:")},g.fxosPhone=function(){return g.fxos()&&k("mobile")},g.fxosTablet=function(){return g.fxos()&&k("tablet")},g.meego=function(){return k("meego")},g.cordova=function(){return window.cordova&&location.protocol==="file:"},g.nodeWebkit=function(){return typeof window.process=="object"},g.mobile=function(){return g.androidPhone()||g.iphone()||g.ipod()||g.windowsPhone()||g.blackberryPhone()||g.fxosPhone()||g.meego()},g.tablet=function(){return g.ipad()||g.androidTablet()||g.blackberryTablet()||g.windowsTablet()||g.fxosTablet()},g.desktop=function(){return!g.tablet()&&!g.mobile()};function Tt(){return{host:new URL(location.href).host,pathname:location.pathname}}function he(e,t,n){return t!=null&&t.length&&typeof e=="object"?t.reduce(function(r,o){var i=window.Headers&&e instanceof Headers?e.get(o):e[o];return i?r+(r===""?"":`

`)+n+" header "+o+": "+i:r},""):""}function Ae(e,t){return e&&["null","undefined"].indexOf(e)===-1?t+": "+e:""}function Ke(i,t,n){t===void 0&&(t="");var r,o,i=typeof((o=i.api)==null?void 0:o.resourceTypeHandler)=="function"?(o=i.api)==null?void 0:o.resourceTypeHandler(n):"";return dn.indexOf(i)===-1&&(r=t===void 0?"":t,o=(n===void 0?"":n).split("?")[0],i=yn.test(o)||vn.some(function(a){return String(r).indexOf(a)!==-1})?"static":"fetch"),i}function Ot(e,t){return e?S.AJAX_ERROR:t?S.RET_ERROR:S.API_RESPONSE}function Ie(e,t){return(e=e.api)!=null&&e.usePerformanceTiming&&typeof t.url=="string"&&(e=(e=performance.getEntriesByName(t.url))==null?void 0:e.pop(),e)?{url:t.url,isHttps:Oe(t.url),method:t.method,type:t.type,status:t.status,duration:Number(e.duration.toFixed(2)),nextHopProtocol:e.nextHopProtocol||"",domainLookup:Te(e.domainLookupEnd-e.domainLookupStart),connectTime:Te(e.connectEnd-e.connectStart)}:{url:t.url,isHttps:Oe(t.url),method:t.method,type:t.type,status:t.status,duration:Number(t.duration.toFixed(2)),nextHopProtocol:"",domainLookup:ne.number,connectTime:ne.number}}var St,xt,ze,Qe,D,Ne,He,Pt=!(g.isIE=function(){return"ActiveXObject"in window}),z=[],Lt=/^\/[^/]/,kt=!1,B=[],Cn=(new A({name:"reportApiSpeed"}),new A({name:"reportApiSpeed",override:!1,onNewAegis:function(e){var t,n;this.override||(this.override=!0,(n=e.config.api)!=null&&n.injectTraceHeader&&(this.traceRequestHeader=new xn(n.injectTraceHeader,(t=n==null?void 0:n.injectTraceIgnoreUrls)!=null?t:[],n==null?void 0:n.injectTraceUrls,n==null?void 0:n.traceFlag)),this.overrideFetch(e.config,e),this.overrideXhr(e.config,e))},overrideFetch:function(e,t){var n=this,r=e.api,r={name:this.name,traceRequestHeader:r!=null&&r.injectTraceHeader?this.traceRequestHeader:null,then:function(a,s,c,u,l){var f,d;ie(c,e.hostUrl)||(f=a.headers?a.headers.get("content-type"):"",(d=Ke(e,f||"",c))==="fetch"?a.clone().text().then(function(p){var T,O=a.status<=0||400<=a.status,R=((R=e.api)==null?void 0:R.reqHeaders)||[],m=he(u==null?void 0:u.headers,R,"req"),R=((R=e.api)==null?void 0:R.resHeaders)||[],w=he(a.headers,R,"res"),v=$e(u==null?void 0:u.headers),R=ft(p,e.api,{url:c,ctx:a,payload:u==null?void 0:u.body}),y=R.code,b=R.isErr,R=(R=e.api)==null?void 0:R.apiDetail,G=R?pe(u==null?void 0:u.body,(T=e.api)==null?void 0:T.reqParamHandler,{url:c}):"",I=R?pe(p,(T=e.api)==null?void 0:T.resBodyHandler,{url:c,ctx:a}):"";setTimeout(function(){var N=Ie(e,{url:c,duration:s,type:d,status:a.status||0,method:(u==null?void 0:u.method)||"get"}),fe=[O?"FETCH_ERROR: "+p:"","fetch req url: "+c,"res status: "+(N.status||0),"res duration: "+N.duration+"ms","res startTime: "+l,m,w,"req method: "+(N.method||"GET"),"res retcode: "+y,Ae(G,"req param"),Ae(I,"res data")].filter(function(q){return q}).join(`

`);N.payload=u==null?void 0:u.body,N.ret=y,N.isErr=+b,n.publishNormalLog({msg:fe,level:Ot(O,b),code:y,trace:v},t),n.publishSpeed(N,t)},0)}):setTimeout(function(){var p=Ie(e,{url:c,duration:s,type:d,status:a.status||0,method:(u==null?void 0:u.method)||"get"});p.type="static",p.urlQuery=oe(c,!0),n.publishSpeed(p,t)},0))},catch:function(a,s,c,u,l){var f,d,p,T,O;throw ie(c,e.hostUrl)||(f=Ke(e,"",c),d=((d=e.api)==null?void 0:d.reqHeaders)||[],p=he(u==null?void 0:u.headers,d,"req"),T=$e(u==null?void 0:u.headers),O=(d=e.api)!=null&&d.apiDetail?pe(u==null?void 0:u.body,(d=e.api)==null?void 0:d.reqParamHandler,{url:c}):"",setTimeout(function(){var m=Ie(e,{url:c,duration:s,type:f,status:0,method:(u==null?void 0:u.method)||"get"}),m=(n.publishSpeed(m,t),"AJAX_ERROR: "+a+`
                          
req url: `+c+`
                          
res status: 0
                          
res duration: `+m.duration+`ms
                          
req method: `+((u==null?void 0:u.method)||"get")+`
                          
req param: `+O+`
                          
res startTime: `+l+`
                          
`+p);n.publishNormalLog({msg:m,level:S.AJAX_ERROR,code:-400,trace:T},t)},0)),a}},o=(this.hackFetchOptions=r,this.hackFetchOptions),i=(r=e.api)==null?void 0:r.ignoreHackReg;if(i===void 0&&(i=/\.flv(\?|$)/i),B.find(function(a){return a.name===o.name}))throw new Error("name '"+o.name+"' is already in hackFetch option list");B.push(o),!kt&&window.fetch&&(kt=!0,Qe=window.fetch,window.fetch=function(a,s){s===void 0&&(s={});var c=typeof a=="string"?a:a==null?void 0:a.url;if((d=i==null?void 0:i.test)!=null&&d.call(i,c))return Qe(c,s);Lt.test(c)&&(c=""+location.origin+c);var u,l,f,d=(o||{}).traceRequestHeader;d&&(u=(u=(s||{}).headers)===void 0?{}:u,l=(f=Tt()).host,f=f.pathname,l=(d=d.generate(c,u,{host:l,pathname:f})||{}).name,f=d.value)&&l&&(s.headers=Object.assign(u,((d={})[l]=f,d)));for(var p=0;p<B.length;p++){var T=B[p];try{typeof T.beforeFetch=="function"&&T.beforeFetch(c,s)}catch{}}var O=Date.now();return Qe(a,s).then(function(m){for(var w=m.clone(),v=0;v<B.length;v++){var y=B[v];try{typeof y.then=="function"&&y.then(w,Date.now()-O,c,s,O)}catch{}}return w}).catch(function(m){for(var w=0;w<B.length;w++){var v=B[w];try{typeof v.catch=="function"&&v.catch(m,Date.now()-O,c,s,O)}catch{}}throw m})})},overrideXhr:function(e,t){var n,r=this,o={name:this.name,ignoreHackReg:(o=e.api)==null?void 0:o.ignoreHackReg,traceRequestHeader:(o=e.api)!=null&&o.injectTraceHeader?this.traceRequestHeader:null,send:function(i,a){var s,c,u=Date.now(),l=(((e==null?void 0:e.api)||{}).injectTraceHeader&&(c=(s=Tt()).host,s=s.pathname,s=(c=r.traceRequestHeader.generate(i.aegisUrl,{},{host:c,pathname:s})||{}).name,c=c.value,s)&&c&&i.setRequestHeader(s,c),i.addEventListener("loadend",function(){var p,T,O,m,w=i.aegisUrl||"";ie(w,e.hostUrl)||i.failType==="abort"||(p="",(i.failType||!i.status||400<=i.status)&&(p=i.failType||"failed"),T=Date.now()-u,O=i.getResponseHeader("content-type")||"",m=Ke(e,O,w),setTimeout(function(){var v=Ie(e,{url:w,duration:T,type:m,status:i.status,method:i.aegisMethod||"get"});if(m==="fetch"){var I=((I=e.api)==null?void 0:I.reqHeaders)||[],y=he(i.aegisXhrReqHeader,I,"req"),I=((I=e.api)==null?void 0:I.resHeaders)||[],b=i.getAllResponseHeaders().split(`\r
`).reduce(function(q,C){return C=C.split(": "),C[0]&&C[1]&&(q[C[0]]=C[1]),q},{}),R=he(b,I,"res"),G=$e(i.aegisXhrReqHeader),I=(b=e.api)==null?void 0:b.apiDetail,N=I?pe(a,(b=e.api)==null?void 0:b.reqParamHandler,{url:w}):"",fe=I?pe(i.response,(b=e.api)==null?void 0:b.resBodyHandler,{url:w}):"";try{(function(q,C,H,j){var Fe,rn,X,on;try{if(typeof(C==null?void 0:C.retCodeHandlerAsync)=="function")return C.retCodeHandlerAsync(q,H==null?void 0:H.url,H==null?void 0:H.ctx,function(Be){var sn=Be.code,Be=Be.isErr;j!=null&&j({code:sn===void 0?U:sn,isErr:Be})});if(typeof(C==null?void 0:C.retCodeHandler)=="function")return X=(rn=C.retCodeHandler(q,H==null?void 0:H.url,H==null?void 0:H.ctx,H==null?void 0:H.payload)||{}).code,on=rn.isErr,j!=null&&j({code:X===void 0?U:X,isErr:on});if(!(q=typeof q=="string"?JSON.parse(q):q))return j!=null&&j({code:U,isErr:!1});typeof((Fe=C==null?void 0:C.ret)==null?void 0:Fe.join)=="function"&&(xe=[].concat(C.ret.map(function(Me){return Me.toLowerCase()})));var an=Object.getOwnPropertyNames(q).filter(function(Me){return xe.indexOf(Me.toLowerCase())!==-1});if(an.length)return(X=q[an[0]])!=="\u672A\u77E5"&&X!==""||(X=U),j!=null&&j({code:""+X,isErr:X!==0&&X!=="0"&&X!==U});j!=null&&j({code:U,isErr:!1})}catch{j!=null&&j({code:U,isErr:!1})}})(i.response,e.api,{url:w,ctx:i,payload:a},function(H){var C=H.code,H=H.isErr,j=[p?"AJAX_ERROR: request "+p:"","fetch req url: "+w,"res status: "+(v.status||0),"res duration: "+v.duration+"ms","res startTime: "+u,y,R,"req method: "+(v.method||"GET"),"res retcode: "+C,Ae(N,"req param"),Ae(fe,"res data")].filter(function(Fe){return Fe}).join(`

`);v.ret=C,v.isErr=+H,v.payload=a,r.publishNormalLog({msg:j,level:Ot(!!p,H),code:C,trace:G},t),r.publishSpeed(v,t)})}catch{v.ret=U,r.publishSpeed(v,t)}}else v.type="static",v.urlQuery=oe(w,!0),r.publishSpeed(v,t);i.removeEventListener("abort",l),i.removeEventListener("error",f),i.removeEventListener("timeout",d)},0))}),function(){i.failType="abort"}),f=function(){i.failType="error"},d=function(){i.failType="timeout"};i.addEventListener("abort",l),i.addEventListener("error",f),i.addEventListener("timeout",d)}};this.hackXHROptions=o,n=this.hackXHROptions,z.find(function(i){return i.name===n.name})||(z.push(n),!Pt&&window.XMLHttpRequest&&(St=window.XMLHttpRequest.prototype.send,xt=window.XMLHttpRequest.prototype.open,ze=window.XMLHttpRequest.prototype.setRequestHeader,Pt=!0,window.XMLHttpRequest.prototype.open=function(){this.aegisMethod=arguments[0];var i,a=arguments[1];if(Lt.test(a)&&(a=""+location.origin+a),this.aegisUrl=a,(a=(i=n.ignoreHackReg)==null?void 0:i.test)==null||!a.call(i,this.aegisUrl))if(this.aegisXhrStartTime=Date.now(),this.sendByAegis)g.isIE()||(this.timeout=5e3);else for(var s=0;s<z.length;s++){var c=z[s];try{typeof c.open=="function"&&c.open(this)}catch{}}return xt.apply(this,arguments)},window.XMLHttpRequest.prototype.setRequestHeader=function(){var i,a,s;return(a=(s=n.ignoreHackReg)==null?void 0:s.test)!=null&&a.call(s,this.aegisUrl)?ze.apply(this,arguments):(a=arguments[0],s=arguments[1],this.aegisXhrReqHeader=(i=this.aegisXhrReqHeader)!=null?i:{},n!=null&&n.traceRequestHeader&&-1<["traceparent","b3","sw8","sentry-trace"].indexOf(a)&&(this.aegisXhrReqHeader[a]||(arguments[1]=s),this.aegisXhrReqHeader[a])?void 0:(this.aegisXhrReqHeader[a]=arguments[1],ze.apply(this,arguments)))},window.XMLHttpRequest.prototype.send=function(){var i,a;if(!((a=(i=n.ignoreHackReg)==null?void 0:i.test)!=null&&a.call(i,this.aegisUrl)||this.sendByAegis))for(var s=0;s<z.length;s++){var c=z[s];try{typeof c.send=="function"&&c.send(this,arguments[0])}catch{}}return St.apply(this,arguments)}))},publishSpeed:function(e){var t=this;this.$walk(function(n){var r=t.$getConfig(n);e.type!=="fetch"||typeof(r==null?void 0:r.urlHandler)!="function"?(e.url=oe(e.url),n.speedLogPipeline(e)):n.speedLogPipeline(P(P({},e),{url:oe(r.urlHandler(e.url,e.payload))}))})},publishNormalLog:function(e){this.$walk(function(t){t.normalLogPipeline(e)})},destroy:function(){var e,t,n;this.option.publishSpeed=function(){},this.option.publishNormalLog=function(){},this.option.hackXHROptions&&(e=this.option.hackXHROptions,(n=z.findIndex(function(r){return r.name===e.name}))!==-1)&&z.splice(n,1),this.option.hackFetchOptions&&(t=this.option.hackFetchOptions,(n=B.findIndex(function(r){return r.name===t.name}))!==-1)&&B.splice(n,1),this.option.override=!1}})),ge={},An=new A({name:"reportBridgeSpeed",override:!1,onNewAegis:function(e){this.override||(this.override=!0,this.overrideBridge(e))},publishSpeed:function(e,t){this.$walk(function(n){n===t&&n.speedLogPipeline(e)})},overrideBridge:function(e){var t=this,n=e.config;n.reportBridgeSpeed&&n.h5Bridge&&n.h5BridgeFunc.length&&n.h5BridgeFunc.forEach(function(r){var o=n.h5Bridge[r];ge[r]=o,n.h5Bridge[r]=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=i[0],c=i[1],u=i[2],l=i[3],f=Date.now();o(s,c,u,function(d){var p=ft(d,n.api),T=p.code,p=p.isErr,T={url:s+"-"+c,name:s+"-"+c,duration:Date.now()-f,type:"bridge",ret:T,isErr:+p};t.publishSpeed(T,e),l(d)})}})},unHackBridge:function(e){Object.keys(ge).forEach(function(t){ge[t]&&(e.config.h5Bridge[t]=ge[t])}),ge={}},destroy:function(e){this.option.publishSpeed=function(){},this.option.unHackBridge(e),this.option.override=!1}});(x=D=D||{})[x.unknown=100]="unknown",x[x.wifi=1]="wifi",x[x.net2g=2]="net2g",x[x.net3g=3]="net3g",x[x.net4g=4]="net4g",x[x.net5g=5]="net5g",x[x.net6g=6]="net6g",(x=Ne=Ne||{})[x.android=1]="android",x[x.ios=2]="ios",x[x.windows=3]="windows",x[x.macos=4]="macos",x[x.linux=5]="linux",x[x.other=100]="other",(x=He=He||{})[x.unknown=100]="unknown",x[x.normal=0]="normal",x[x.weak=1]="weak",x[x.disconnected=2]="disconnected";function W(e,t,n,r){return n===void 0&&(n=15e3),r===void 0&&(r=0),(t=t===void 0?0:t)<=e&&e<=n?e:r}var ce,Q,me,Ct,Ue,ue,At,It,Ye,x=new A({name:"device",onNewAegis:function(e){e.extendBean("platform",this.getPlatform()),e.extendBean("netType",D.unknown),this.getDpi(e),this.refreshNetworkTypeToBean(e),this.refreshNetworkStatusToBean(e)},getDpi:function(e){e.extendBean("vp",Math.round(window.innerWidth)+" * "+Math.round(window.innerHeight)),window.screen&&e.extendBean("sr",Math.round(window.screen.width)+" * "+Math.round(window.screen.height))},getPlatform:function(){var e={android:/\bAndroid\s*([^;]+)/,ios:/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,windows:/\b(Windows NT)/,macos:/\b(Mac OS)/,linux:/\b(Linux)/i},t=Object.keys(e).find(function(n){return e[n].test(navigator.userAgent)});return t?Ne[t]:Ne.other},refreshNetworkTypeToBean:function(e){var t=this,n=e.config;n&&(typeof n.getNetworkType=="function"?n.getNetworkType:Nt)(function(r){D[r]||(r=D.unknown),e.extendBean("netType",r),t.NetworkRefreshTimer=setTimeout(function(){t.refreshNetworkTypeToBean(e),clearTimeout(t.NetworkRefreshTimer)},1e4)})},refreshNetworkStatusToBean:function(e){var t,n=this,r=e.config;r&&(t=typeof r.getNetworkStatus=="function"?r.getNetworkStatus:t)!=null&&t(function(o){He[o]===void 0&&(o=He.unknown),e.extendBean("netStatus",o),n.NetworkStatusRefreshTimer=setTimeout(function(){n.refreshNetworkStatusToBean(e),clearTimeout(n.NetworkStatusRefreshTimer)},1e4)})}}),Nt=function(e){var t="",n=navigator.userAgent.match(/NetType\/(\w+)/);n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),e((n=t=t||U,0<=(n=String(n).toLowerCase()).indexOf("4g")?D.net4g:0<=n.indexOf("wifi")?D.wifi:0<=n.indexOf("5g")?D.net5g:0<=n.indexOf("6g")?D.net6g:0<=n.indexOf("3g")?D.net3g:0<=n.indexOf("2g")?D.net2g:D.unknown))},In=window.WebSocket,$=[],Nn={construct:function(e,t){var n=new e(t[0],t[1]);return n.originSend=n.send,n.addEventListener("error",function(o){var o=(o==null?void 0:o.currentTarget)||{},i=o.url,a=o.readyState;$!=null&&$.forEach(function(s){s=s.onErr,s!=null&&s({msg:"\u65E0\u6CD5\u83B7\u77E5\u5177\u4F53\u9519\u8BEF\u4FE1\u606F\uFF0C\u9700\u5728\u6D4F\u89C8\u5668\u63A7\u5236\u53F0\u67E5\u770B\uFF01",readyState:a,connectUrl:i})})}),Object.defineProperty(n,"send",{get:function(){return function(i){(o=n.originSend)!=null&&o.call(n,i);var o=n.readyState,i=WebSocket.OPEN,a=WebSocket.CLOSED,s=WebSocket.CONNECTING,c=WebSocket.CLOSING;if(o!==i){var u={readyState:o,connectUrl:n.url};switch(o){case a:$.forEach(function(l){l=l.sendErr,l!=null&&l(P({msg:"\u6D88\u606F\u53D1\u9001\u5931\u8D25\uFF0C\u8FDE\u63A5\u5DF2\u5173\u95ED\uFF01"},u))});break;case s:$.forEach(function(l){(0,l.sendErr)(P({msg:"\u6D88\u606F\u53D1\u9001\u5931\u8D25\uFF0C\u6B63\u5728\u8FDE\u63A5\u4E2D\uFF01"},u))});break;case c:$.forEach(function(l){(0,l.sendErr)(P({msg:"\u6D88\u606F\u53D1\u9001\u5931\u8D25\uFF0C\u8FDE\u63A5\u6B63\u5728\u5173\u95ED\uFF01"},u))})}}}}}),n}},Ht=new A({name:"onError"}),Hn=Ht=new A({name:"onError",onNewAegis:function(e){this.startListen(e)},startListen:function(e){function t(u){var l,f=u&&J(u.reason);f&&s.publishErrorLog({msg:"PROMISE_ERROR: "+f,errorMsg:(l=(u=((l=u.reason)==null?void 0:l.message)||((l=u.reason)==null?void 0:l.errMsg)||f)==null?void 0:u.slice)==null?void 0:l.call(u,0,150),level:S.PROMISE_ERROR},e)}function n(u){var l;if(u=(u==null?void 0:u.target)||(u==null?void 0:u.srcElement)){var f=u.src||u.href||"",u=u.tagName,u=u===void 0?"script":u;if(!(ie(l=f,e.config.hostUrl)||-1<window.location.href.indexOf(l))){var d={msg:u+" load fail: "+f,level:S.INFO};if(/\.js$/.test(f))d.level=S.SCRIPT_ERROR;else if(/\.css$/.test(f))d.level=S.CSS_ERROR;else switch(u.toLowerCase()){case"script":d.level=S.SCRIPT_ERROR;break;case"link":d.level=S.CSS_ERROR;break;case"img":d.level=S.IMAGE_ERROR;break;case"audio":case"video":d.level=S.MEDIA_ERROR;break;default:return}s.publishErrorLog(d,e)}}}var r,o,i,a,s=this,c=window.onerror;window.onerror=function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var f,d=J(u[0]);typeof(f=d)!="string"||!f||fn.some(function(p){return-1<f.indexOf(p)})||ct.some(function(p){return-1<f.indexOf(p)})||s.publishErrorLog({msg:(d||"")+" @ ("+(J(u[1])||"")+":"+(u[2]||0)+":"+(u[3]||0)+`)
          
`+J(u[4]||""),level:S.ERROR},e),c!=null&&c.call.apply(c,de([window],u))},window.addEventListener("unhandledrejection",t),window.document.addEventListener("error",n,!0),e.lifeCycle.on("destroy",function(){Ht.countInstance()===0&&(window.document.removeEventListener("unhandledrejection",t),window.document.removeEventListener("error",n,!0))}),e.config.websocketHack&&(r={key:e.config.id+"-"+this.name,onErr:function(u){var l;(l=s.publishWsErrorLog)!=null&&l.call(s,u,e)},sendErr:function(u){var l;(l=s.publishWsErrorLog)!=null&&l.call(s,u,e)}},this.hackWebsocketConfig=r,r=this.hackWebsocketConfig,window.Proxy)&&window.WebSocket&&(o=window.WebSocket,window&&!o.isHack&&(i=new Proxy(WebSocket,Nn),o.isHack=!0,window.WebSocket=i),a=r,$.find(function(u){return u.key===a.key})||a&&$.push(a))},publishErrorLog:function(e,t){this.$walk(function(n){n===t&&n.normalLogPipeline(e)})},publishWsErrorLog:function(o,t){var n=o.connectUrl,r=o.msg,o=o.readyState;this.publishErrorLog({msg:`WEBSOCKET_ERROR: 
              connect: `+n+`
              readyState: `+o+`
              msg: `+r,level:S.WEBSOCKET_ERROR},t)},destroy:function(){var e,t;this.option.publishErrorLog=function(){},this.option.hackWebsocketConfig&&(e=this.option.hackWebsocketConfig,window.WebSocket=In,(t=$.findIndex(function(n){return n.key===e.key}))!==-1)&&$.splice(t,1)}}),Ut=(new A({name:"pagePerformance"}),3),Un=new A({name:"pagePerformance",performanceMap:{},onNewAegis:function(e){ke()&&(ce?this.publish(ce,e):this.startCalcPerformance(e))},publish:function(e,t){var n=this;this.$walk(function(r){r===t&&r.sendPipeline([function(o,i){var a,s=[];for(a in o)s.push(a+"="+o[a]);var c,u=n.$getConfig(r);if(u)return c=((c=r.config.performanceUrl)==null?void 0:c.indexOf("?"))===-1?"?":"&",typeof u.urlHandler=="function"?i({url:r.config.performanceUrl+c+s.join("&")+"&from="+(encodeURIComponent(u.urlHandler())||window.location.href),beanFilter:["from"],type:L.PERFORMANCE,log:o}):i({url:r.config.performanceUrl+c+s.join("&"),type:L.PERFORMANCE,log:o})}],L.PERFORMANCE)(P({},e))})},startCalcPerformance:function(e){var t=this;try{this.getFirstScreenTiming(e,function(n){var r=performance.timing;r&&(ce={dnsLookup:W(r.domainLookupEnd-r.domainLookupStart),tcp:W(r.connectEnd-r.connectStart),ssl:W(r.secureConnectionStart===0?0:r.requestStart-r.secureConnectionStart),ttfb:W(r.responseStart-r.requestStart),contentDownload:W(r.responseEnd-r.responseStart),domParse:W(r.domInteractive-r.domLoading,0,15e3,1070),resourceDownload:W(r.loadEventStart-r.domInteractive,0,15e3,1070),firstScreenTiming:W(Math.floor(n),0,15e3,15e3)},(r=e.config).extraPerformanceData&&JSON.stringify(r.extraPerformanceData)!=="{}"&&(r=(n=r.extraPerformanceData).engineInit,n=n.bundleLoad,ce=P(P({},ce),{engineInit:W(r,0,1e4),bundleLoad:W(n,0,1e4)})),t.publish(ce,e))})}catch{}},getFirstScreenTiming:function(e,t){var n=this;e.lifeCycle.on("destroy",function(){f&&clearTimeout(f)});var r,o=this,i=["script","style","link","br"],a=[],s={},c=(-1<((u=(u=window.PerformanceObserver)==null?void 0:u.supportedEntryTypes)==null?void 0:u.indexOf("paint"))&&(r=new PerformanceObserver(function(d){d.getEntries().forEach(function(p){var T;p.entryType==="paint"&&p.name==="first-contentful-paint"&&0<(T=document.querySelectorAll("[AEGIS-FIRST-SCREEN-TIMING]")).length&&e.config.id&&!n.performanceMap[e.config.id]&&(n.setFirstScreenInfo(e,p.startTime,T[0],T),t!=null&&t(p.startTime),c.disconnect(),r.disconnect(),f)&&clearTimeout(f)})})).observe({entryTypes:["paint"]}),new MutationObserver(function(d){var p={roots:[],ignores:[],rootsDomNum:[],time:performance.now()};d.forEach(function(T){T&&T.addedNodes&&Array.prototype.slice.call(T.addedNodes).forEach(function(O){o.isEleInArray(O,p.ignores)?p.ignores.push(O):O.nodeType===1&&O.hasAttribute("AEGIS-FIRST-SCREEN-TIMING")?(Object.prototype.hasOwnProperty.apply(s,[p.time])||(s[p.time]=[]),s[p.time].push(O)):O.nodeType===1&&(o.hasAncestorOrSelfWithAttribute(O,"AEGIS-IGNORE-FIRST-SCREEN-TIMING")?p.ignores.push(O):i.indexOf(O.nodeName.toLocaleLowerCase())!==-1||o.isEleInArray(O,p.roots)||(p.roots.push(O),p.rootsDomNum.push(o.walkAndCount(O)||0)))})}),p.roots.length&&a.push(p)}));c.observe(document,{childList:!0,subtree:!0});var u,l=function(d){(d=d===void 0?0:d)||(p=0,(O=Object.keys(s)).length?(d=Math.max.apply(null,O),n.setFirstScreenInfo(e,d,(O=s[d])==null?void 0:O[0],s)):a.forEach(function(y){for(var b=0;b<y.roots.length;b++)y.rootsDomNum[b]>p&&o.isInFirstScreen(y.roots[b])&&(p=y.rootsDomNum[b],d=y.time,n.setFirstScreenInfo(e,d,y.roots[b]))}),a.length=0,Object.keys(s).forEach(function(y){s[y]=s[y].map(function(b){var R={tagName:b.tagName},G=b.attributes;if(!G)return b;for(var I=0;I<G.length;I++){var N=G[I];N.name&&(R[N.name]=b.getAttribute(N.name))}return R})}));var p,O=performance.timing,T=O.domInteractive-O.domLoading,O=O.loadEventStart-O.domInteractive,m=d;f=null;for(var w=0,v=[T,O,m];w<v.length;w++)if(v[w]<=0&&0<Ut){f=setTimeout(function(){return l(m)},3e3);break}f?--Ut:(c.disconnect(),r!=null&&r.disconnect(),t!=null&&t(d))},f=setTimeout(function(){return l()},3e3)},setFirstScreenInfo:function(e,t,n,r){var o;e.config.id&&this.performanceMap[e.config.id]||(e.config.id&&(this.performanceMap[e.config.id]=!0),(typeof((o=e.config)==null?void 0:o.pagePerformance)!="object"||(o=e.config.pagePerformance)!=null&&o.firstScreenInfo)&&(e.firstScreenInfo={element:n,timing:t,markDoms:r}))},isEleInArray:function(e,t){return!(!e||e===document.documentElement)&&(t.indexOf(e)!==-1||this.isEleInArray(e.parentElement,t))},isInFirstScreen:function(e){var t,n;return!(!e||typeof e.getBoundingClientRect!="function")&&(e=e.getBoundingClientRect(),t=window.innerHeight,n=window.innerWidth,0<=e.left)&&e.left<n&&0<=e.top&&e.top<t&&0<e.width&&0<e.height},walkAndCount:function(e){var t=0;if(e&&e.nodeType===1){t+=1;var n=e.children;if(n!=null&&n.length)for(var r=0;r<n.length;r++)n[r].nodeType===1&&n[r].hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING")||(t+=this.walkAndCount(n[r]))}return t},hasAncestorOrSelfWithAttribute:function(e,t){for(var n=e;n&&n!==document.body;){if(n.hasAttribute(t))return!0;n=n.parentElement}return!1}});function qt(){Ue=[],me=-1,Q=null,Dt(addEventListener)}function jt(e,t){Q||(Q=t,me=e,Ct=new Date,Dt(removeEventListener),_t())}function _t(){var e;0<=me&&me<Ct-At&&(e={entryType:"first-input",name:Q.type,target:Q.target,cancelable:Q.cancelable,startTime:Q.timeStamp,processingStart:Q.timeStamp+me},Ue.forEach(function(t){t(e)}),Ue=[])}function Dt(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,It,ue)})}ue={passive:!0,capture:!0},At=new Date,It=function(e){var t,n,r,o;function i(){jt(n,r),o()}function a(){o()}e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,e.type=="pointerdown"?(n=t,r=e,o=function(){removeEventListener("pointerup",i,ue),removeEventListener("pointercancel",a,ue)},addEventListener("pointerup",i,ue),addEventListener("pointercancel",a,ue)):jt(t,e))},Ye=document.visibilityState==="hidden"?0:1/0,addEventListener("visibilitychange",function e(t){document.visibilityState==="hidden"&&(Ye=t.timeStamp,removeEventListener("visibilitychange",e,!0))},!0),qt(),self.webVitals={firstInputPolyfill:function(e){Ue.push(e),_t()},resetFirstInputPolyfill:qt,get firstHiddenTime(){return Ye}};function Y(e,t){var n=$t(),r="navigate";return 0<=Vt?r="back-forward-cache":n&&(document.prerendering||0<it()?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t===void 0?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}}function qe(e,t,n){try{var r;if(PerformanceObserver.supportedEntryTypes.includes(e))return(r=new PerformanceObserver(function(o){Promise.resolve().then(function(){t(o.getEntries())})})).observe(Object.assign({type:e,buffered:!0},n||{})),r}catch{}}function Z(e,t,n,r){var o,i;return function(a){0<=t.value&&(a||r)&&((i=t.value-(o||0))||o===void 0)&&(o=t.value,t.delta=i,t.rating=(a=t.value)>n[1]?"poor":a>n[0]?"needs-improvement":"good",e(t))}}function Ze(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})}function et(e){function t(n){n.type!=="pagehide"&&document.visibilityState!=="hidden"||e(n)}addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)}function tt(e){var t=!1;return function(n){t||(e(n),t=!0)}}function nt(){return le<0&&(le=Jt(),Kt(),ye(function(){setTimeout(function(){le=Jt(),Kt()},0)})),{get firstHiddenTime(){return le}}}function rt(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()}function Ft(e,t){t=t||{},rt(function(){var n,r=nt(),o=Y("FCP"),i=qe("paint",function(a){a.forEach(function(s){s.name==="first-contentful-paint"&&(i.disconnect(),s.startTime<r.firstHiddenTime)&&(o.value=Math.max(s.startTime-it(),0),o.entries.push(s),n(!0))})});i&&(n=Z(e,o,zt,t.reportAllChanges),ye(function(a){o=Y("FCP"),n=Z(e,o,zt,t.reportAllChanges),Ze(function(){o.value=performance.now()-a.timeStamp,n(!0)})}))})}function Mt(){var e;0<=ve&&ve<Gt-jn&&(e={entryType:"first-input",name:ee.type,target:ee.target,cancelable:ee.cancelable,startTime:ee.timeStamp,processingStart:ee.timeStamp+ve},_e.forEach(function(t){t(e)}),_e=[])}function qn(e){var t,n,r,o;function i(){Yt(n,r),o()}function a(){o()}e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,e.type=="pointerdown"?(n=t,r=e,o=function(){removeEventListener("pointerup",i,we),removeEventListener("pointercancel",a,we)},addEventListener("pointerup",i,we),addEventListener("pointercancel",a,we)):Yt(t,e))}function Bt(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,qn,we)})}function Wt(e,t){function n(o,i,a,s){function c(u){o==="visibilitychange"&&document.visibilityState!=="hidden"||(s?setTimeout(function(){return i(u)},s):i(u),a&&removeEventListener(o,c,!0))}addEventListener(o,c,!0)}var r;n("visibilitychange",e,t==null?void 0:t.once,(r=t==null?void 0:t.delay)==null?void 0:r.visibilitychange),n("pagehide",e,t==null?void 0:t.once,(r=t==null?void 0:t.delay)==null?void 0:r.pagehide)}function je(e){var t=e.name;0<(e=e.value)&&(tn[t]=e)}var ee,ve,Gt,_e,Xt,ot,Vt=-1,ye=function(e){addEventListener("pageshow",function(t){t.persisted&&(Vt=t.timeStamp,e(t))},!0)},$t=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},it=function(){var e=$t();return e&&e.activationStart||0},le=-1,Jt=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},De=function(e){document.visibilityState==="hidden"&&-1<le&&(le=e.type==="visibilitychange"?e.timeStamp:0,removeEventListener("visibilitychange",De,!0),removeEventListener("prerenderingchange",De,!0))},Kt=function(){addEventListener("visibilitychange",De,!0),addEventListener("prerenderingchange",De,!0)},zt=[1800,3e3],Qt=[.1,.25],we={passive:!0,capture:!0},jn=new Date,Yt=function(e,t){ee||(ee=t,ve=e,Gt=new Date,Bt(removeEventListener),Mt())},Zt=[100,300],en=[2500,4e3],at={},tn=(new A({name:"webVitals"}),{FCP:-1,LCP:-1,FID:-1,CLS:-1}),_n=new A({name:"webVitals",onNewAegis:function(e){if(ke()&&typeof window.PerformanceObserver=="function"&&typeof performance.getEntriesByName=="function")try{Ft(je),i=je,a={},rt(function(){function s(p){(p=p[p.length-1])&&p.startTime<l.firstHiddenTime&&(f.value=Math.max(p.startTime-it(),0),f.entries=[p],c())}var c,u,l=nt(),f=Y("LCP"),d=qe("largest-contentful-paint",s);d&&(c=Z(i,f,en,a.reportAllChanges),u=tt(function(){at[f.id]||(s(d.takeRecords()),d.disconnect(),at[f.id]=!0,c(!0))}),["keydown","click"].forEach(function(p){addEventListener(p,function(){return setTimeout(u,0)},!0)}),et(u),ye(function(p){f=Y("LCP"),c=Z(i,f,en,a.reportAllChanges),Ze(function(){f.value=performance.now()-p.timeStamp,at[f.id]=!0,c(!0)})}))}),r=je,o={},rt(function(){function s(p){p.startTime<u.firstHiddenTime&&(l.value=p.processingStart-p.startTime,l.entries.push(p),d(!0))}function c(p){p.forEach(s)}var u=nt(),l=Y("FID"),f=qe("first-input",c),d=Z(r,l,Zt,o.reportAllChanges);f&&et(tt(function(){c(f.takeRecords()),f.disconnect()})),f&&ye(function(){l=Y("FID"),d=Z(r,l,Zt,o.reportAllChanges),_e=[],ve=-1,ee=null,Bt(addEventListener),_e.push(s),Mt()})}),t=je,n={},Ft(tt(function(){function s(p){p.forEach(function(T){var O,m;T.hadRecentInput||(O=f[0],m=f[f.length-1],l&&T.startTime-m.startTime<1e3&&T.startTime-O.startTime<5e3?(l+=T.value,f.push(T)):(l=T.value,f=[T]))}),l>u.value&&(u.value=l,u.entries=f,c())}var c,u=Y("CLS",0),l=0,f=[],d=qe("layout-shift",s);d&&(c=Z(t,u,Qt,n.reportAllChanges),et(function(){s(d.takeRecords()),c(!0)}),ye(function(){u=Y("CLS",l=0),c=Z(t,u,Qt,n.reportAllChanges),Ze(function(){return c()})}),setTimeout(c,0))})),Wt(this.publish.bind(this,e),{once:!0,delay:{visibilitychange:10}})}catch{}var t,n,r,o,i,a},publish:function(e){this.$walk(function(t){var n;t===e&&(n=t.sendPipeline)!=null&&n.call(t,[function(r,o){var i,a=[];for(i in r)a.push(i+"="+r[i]);var s=((s=(s=t.config)==null?void 0:s.performanceUrl)==null?void 0:s.indexOf("?"))===-1?"?":"&";o({url:t.config.webVitalsUrl+s+a.join("&"),type:L.VITALS,log:r,sendBeacon:!0})}],L.VITALS)(P({},tn))})},destroy:function(){this.option.publish=function(){}}}),Dn=(new A({name:"spa"}),["replaceState","pushState","popstate","hashchange"]),Fn=new A({name:"spa",originFireUrl:"",onNewAegis:function(e){var t=this;history.pushState=this.wr("pushState")||history.pushState,history.replaceState=this.wr("replaceState")||history.replaceState,this.sendPv=this.sendPv.bind(this),e.config.spa&&this.sendPv(e),Dn.forEach(function(n){return window.addEventListener(n,function(){return t.sendPv.call(t,e)})})},wr:function(e){var t=history[e],n="__"+e+"__hasWrittenByTamSpa";return typeof t=="function"&&!history[n]&&(Object.defineProperty(history,n,{value:!0,enumerable:!1}),function(){var r=t.apply(this,arguments),o=null;return typeof Event=="function"?o=new Event(e):(o=document.createEvent("HTMLEvents")).initEvent(e,!1,!0),window.dispatchEvent(o),r})},sendPv:function(e){var t=this;setTimeout(function(){var n=location.pathname+location.hash+e.config.id;t.$walk(function(r){var o;r===e&&(o=r.config.pvUrl)&&n&&n!==t.originFireUrl&&(r.sendPipeline([function(i,a){a({url:""+o,type:L.PV})}],L.PV)(null),t.originFireUrl=n)})},0)},destroy:function(){this.option.sendPv=function(){}}}),h=(st(ot=F,h=Xt=h),ot.prototype=h===null?Object.create(h):(nn.prototype=h.prototype,new nn),F.prototype.getBean=function(e){var t=this;return e===void 0&&(e=[]),""+Object.getOwnPropertyNames(this.bean).filter(function(n){return e.indexOf(n)===-1}).map(function(n){return n==="from"?"from="+t.getCurrentPageUrl():n+"="+t.bean[n]}).join("&")},F.prototype.getCurrentPageUrl=function(){var e=this.config.pageUrl||location.href,e=(e=typeof this.config.urlHandler=="function"?this.config.urlHandler()||location.href:e).slice(0,2048);return encodeURIComponent(e)},F.prototype.ready=function(){function e(){var n,r,o,i;t.reportRequestQueue.length&&(n=t.reportRequestQueue.splice(0,1)[0],r=n.options,o=n.success,i=n.fail,t.$request(r,function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];try{return o==null?void 0:o.apply(r,a)}finally{e()}},function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];try{return i==null?void 0:i.apply(r,a)}finally{e()}}))}var t=this;e(),this.isReportReady=!0},F.prototype.request=function(e,t,n){this.config.reportImmediately||this.isReportReady?this.$request(e,t,n):this.reportRequestQueue.push({options:e,success:t,fail:n})},F.prototype.$request=function(e,t,n){var r,o,i,a;if(e&&typeof e.url=="string"&&e.url!==""&&this.bean.id)return a=e.url,e.addBean!==!1&&(a=function(s,c){var u,l,f,d=s,p=e.beanFilter||[];for(u in c)p.indexOf(u)===-1&&((f=(l=new RegExp("([?&])"+u+"(=([^&]*))?(?=&|$)")).exec(d))?f[2]&&f[3]!==""&&f[3]!=="undefined"||(d=d.replace(l,"$1"+u+"="+c[u])):(f=-1<d.indexOf("?")?"&":"?",d+=f+u+"="+c[u]));return d}(a,P(P({},this.bean),{from:this.getCurrentPageUrl()}))),e.url=a,a=e.method||"get",o=this.config.onBeforeRequest,(e=o?o(e,this):e)?e.url?void((e!=null&&e.sendBeacon||this.sendNow)&&typeof(navigator==null?void 0:navigator.sendBeacon)=="function"?navigator.sendBeacon(e.url,e.data):((r=new XMLHttpRequest).sendByAegis=!0,r.addEventListener("readystatechange",function(){r.readyState===4&&(400<=r.status||r.status===0?n!=null&&n(r.response):t!=null&&t(r.response))}),a.toLocaleLowerCase()==="get"?(r.open("get",(o=e.url,i=e.data,typeof o!="string"?"":typeof i=="object"&&i?(a=Object.getOwnPropertyNames(i).map(function(s){var c=i[s];return s+"="+encodeURIComponent(typeof c=="string"?c:JSON.stringify(c))}).join("&").replace(/eval/gi,"evaI"),o+(o.indexOf("?")===-1?"?":"&")+a):o)),r.send()):(r.open("post",e.url),e.contentType&&r.setRequestHeader("Content-Type",e.contentType),typeof e.data=="string"&&(e.data=e.data.replace(/eval/gi,"evaI")),r.send(e.data)))):console.warn("Please handle the parameters reasonably, options.url is necessary"):console.warn("Sending request blocked")},F.prototype.publishPluginsLogs=function(){var e=F.installedPlugins.find(function(t){return t.name==="reportAssetSpeed"});e!=null&&e.option.collectNotReportedLog(this)},F.prototype.uploadLogs=function(e,t){var n;e===void 0&&(e={}),t===void 0&&(t={}),(n=this.lifeCycle)!=null&&n.emit("uploadLogs",e,t)},F.sessionID="session-"+Date.now(),F);function F(e){var t,n,r,o,i=Xt.call(this,e)||this;i.sendNow=!1,i.isReportReady=!1,i.reportRequestQueue=[],i.speedLogPipeline=se([Se(i),(o=i.config,function(a,s){var c,u,l,f=typeof o.repeat=="number"?o.repeat:60;!o.speedSample||f<=0?s(a):(c=(o==null?void 0:o.id)||"0",u=ae[c]||{},Array.isArray(a)?(l=a.filter(function(d){var p=!u[d.url]||u[d.url]<f;return p?(u[d.url]=1+~~u[d.url],ae[c]=u):te[c]||Xe(c),p})).length&&s(l):!u[a.url]||u[a.url]<f?(u[a.url]=1+~~u[a.url],ae[c]=u,s(a)):te[c]||Xe(c))}),(r=i,function(a,s){Nt(function(c){r.extendBean("netType",c),s(a)})}),function(a,s){(c=i.lifeCycle)!=null&&c.emit("beforeReportSpeed",a);var c,u=i.config.beforeReportSpeed;if((a=typeof u=="function"?a.filter(function(l){return u(l)!==!1}):a).length)return s(a)},function(a,s){s(a.map(function(c){return c.payload!==void 0&&delete c.payload,c}))},function(a){return i.sendPipeline([function(s,c){var u,l,f,d;c({type:L.SPEED,url:""+i.config.speedUrl,method:"post",data:(c=s,u=P(P({},i.bean),{from:i.getCurrentPageUrl()}),f={fetch:[],static:[],bridge:[]},d=new FormData,Array.isArray(c)?c.forEach(function(p){var T=Rt(p);f[p.type].push(T)}):(l=Rt(c),f[c.type].push(l)),d.append("payload",ht(P({duration:f},u))),d),log:s})}],L.SPEED)(a)}]),e.asyncPlugin=!0;try{typeof document<"u"&&(e.uin=e.uin||((t=document.cookie.match(/\buin=\D+(\d*)/))!=null?t:[])[1]||((n=document.cookie.match(/\bilive_uin=\D*(\d+)/))!=null?n:[])[1]||""),i.init(e),i.extendBean("sessionId",F.sessionID),i.extendBean("from",i.getCurrentPageUrl()),typeof document<"u"&&i.extendBean("referer",encodeURIComponent(document.referrer||"")),e.ext1&&i.extendBean("ext1",encodeURIComponent(e.ext1)),e.ext2&&i.extendBean("ext2",encodeURIComponent(e.ext2)),e.ext3&&i.extendBean("ext3",encodeURIComponent(e.ext3))}catch(a){console.warn(a),console.log(`%cThe above error occurred in the process of initializing Aegis, which will affect your normal use of Aegis.
It is recommended that you contact us for feedback and thank you for your support.`,"color: red"),i.sendSDKError(a)}return i}function nn(){this.constructor=ot}new A({name:"ie"}),new A({name:"onClose"});var Mn=new A({name:"onClose",onNewAegis:function(e){var t,n=this;g.desktop()?(t=window.onunload,window.onunload=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n.publishNotReportedLog(e),t!=null&&t.call.apply(t,de([window],r))}):Wt(this.publishNotReportedLog.bind(this,e),{once:!0})},publishNotReportedLog:function(e){var t=this;this.$walk(function(n){n===e&&(n.sendNow=!0,n.publishPluginsLogs(),t.publishThrottlePipeLogs(n))})},publishThrottlePipeLogs:function(e){e!=null&&e.speedLogPipeline([]),e!=null&&e.eventPipeline([]),e!=null&&e.customTimePipeline([]),e!=null&&e.normalLogPipeline([])}});return new A({name:"aid"}),h.use(Hn),h.use(Cn),h.use(Ln),h.use(Un),h.use(_n),h.use(Pn),h.use(x),h.use(Fn),h.use(Mn),h.use(An),h})})(cn);const Xn=cn.exports;export{Xn as A};
