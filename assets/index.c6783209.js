import{d as N,g as R,_ as j}from"./index.50b71120.js";import{$ as x,S as F,a0 as Y,P as q,Y as G,d as H,k as J,U as M,_ as O,a1 as Q}from"./@arco-design.2114ce1c.js";import"./vue.ffb667bf.js";import{u as X}from"./loading.566f8821.js";import{e as v,b as V,f as g,j as Z,s as P,g as U,k as I,i as z}from"./serial.3a8dd4af.js";import{d as tt,h as ot,o as et,a as at,x as a,u as r,z as B,A as E,_ as nt}from"./@vue.6ceb3fa6.js";import"./vue-router.a9f5d186.js";import"./nprogress.6328d444.js";import"./@intlify.02b6985d.js";import"./mitt.550594b0.js";import"./pinia.fa8b6be2.js";import"./vue-demi.0e7683c7.js";import"./axios.06033baf.js";import"./vue-i18n.5fb6db72.js";import"./tdesign-vue-next.ed813ef2.js";import"./lodash-es.18922ecc.js";import"./sortablejs.77296005.js";import"./@popperjs.f3f73334.js";import"./@babel.9b6013fe.js";import"./dayjs.35d19ede.js";import"./@vueuse.a7db99fe.js";import"./@zxing.8654f0db.js";import"./@microsoft.d2aaf3b7.js";import"./vue-matomo.5bdfe9a5.js";import"./b-tween.8dd4e2fe.js";import"./b-validate.1fdaeb97.js";import"./number-precision.5cddbed2.js";import"./resize-observer-polyfill.2b976e6e.js";import"./scroll-into-view-if-needed.0a5da943.js";import"./compute-scroll-into-view.17358474.js";const lt={class:"container"},it={name:"Settings"},rt=tt({...it,setup(st){const t=N(),{loading:T,setLoading:$}=X(!1),o=ot({logo_line1:"",logo_line2:"",mdc_audio_local:!0,dtmfid:"",dtmf_up_code:"",dtmf_down_code:""});function W(e,l){if(e.length>l)return!1;for(let s=0;s<e.length;s++){let n=e.charAt(s);if((n<"0"||n>"9")&&(n<"A"||n>"D")&&n!="*"&&n!="#")return!1}return!0}const C=async(e,l,s)=>{var _;e=e.trim();let n;if(e==""){let d=[];for(let f=0;f<s;f++)d.push(0);n=new Uint8Array(d)}else if(W(e,s)){if(n=P(e),n.length<s){let d=new Uint8Array(s);d.set(n),n=d}}else return;await U(t.connectPort,l,n,n.length,(_=t.configuration)==null?void 0:_.uart)},K=async()=>{var n,_,d,f,w,p,u,y,h,b,i,A,S,c,D,k;if(t.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if(await v(t.connectPort),$(!0),((n=t.configuration)==null?void 0:n.charset)=="losehu"){let m=new Uint8Array(38);m.set(await V(t.connectPort,123680,38,(_=t.configuration)==null?void 0:_.uart),0),o.logo_line1=g(m.subarray(0,19),(d=t.configuration)==null?void 0:d.charset),o.logo_line2=g(m.subarray(19,38),(f=t.configuration)==null?void 0:f.charset)}else if(((w=t.configuration)==null?void 0:w.charset)=="gb2312"){let m=new Uint8Array(36);(p=t.firmwareVersion)!=null&&p.startsWith("UVE")?m.set(await Z(t.connectPort,0,36),0):m.set(await V(t.connectPort,8192,36,(u=t.configuration)==null?void 0:u.uart),0),o.logo_line1=g(m.subarray(0,18),(y=t.configuration)==null?void 0:y.charset),o.logo_line2=g(m.subarray(18,36),(h=t.configuration)==null?void 0:h.charset)}else{let m=new Uint8Array(32);m.set(await V(t.connectPort,3760,32,(b=t.configuration)==null?void 0:b.uart),0),o.logo_line1=g(m.subarray(0,16),(i=t.configuration)==null?void 0:i.charset),o.logo_line2=g(m.subarray(16,32),(A=t.configuration)==null?void 0:A.charset)}const e=await V(t.connectPort,3808,8,(S=t.configuration)==null?void 0:S.uart);o.dtmfid=g(e);const l=await V(t.connectPort,3832,16,(c=t.configuration)==null?void 0:c.uart);o.dtmf_up_code=g(l);const s=await V(t.connectPort,3848,16,(D=t.configuration)==null?void 0:D.uart);o.dtmf_down_code=g(s),parseInt(await V(t.connectPort,8189,1,(k=t.configuration)==null?void 0:k.uart))==0?o.mdc_audio_local=!1:o.mdc_audio_local=!0,$(!1)},L=async()=>{var e,l,s,n,_,d,f,w,p,u,y,h,b,i,A,S;if(t.connectState!=!0){alert(sessionStorage.getItem("noticeConnectK5"));return}if($(!0),await v(t.connectPort),((e=t.configuration)==null?void 0:e.charset)=="losehu"){let c=new Uint8Array(38);c.set(P(o.logo_line1,(l=t.configuration)==null?void 0:l.charset).subarray(0,19),0),c.set(P(o.logo_line2,(s=t.configuration)==null?void 0:s.charset).subarray(0,19),19),await U(t.connectPort,123678,[18,18],2,(n=t.configuration)==null?void 0:n.uart),await U(t.connectPort,123680,c,38,(_=t.configuration)==null?void 0:_.uart)}else if(((d=t.configuration)==null?void 0:d.charset)=="gb2312"){let c=new Uint8Array(36);c.set(P(o.logo_line1,(f=t.configuration)==null?void 0:f.charset).subarray(0,18),0),c.set(P(o.logo_line2,(w=t.configuration)==null?void 0:w.charset).subarray(0,18),18),(p=t.firmwareVersion)!=null&&p.startsWith("UVE")?(await I(t.connectPort,36,[18,18],2),await I(t.connectPort,0,c,36)):(await U(t.connectPort,8228,[18,18],2,(u=t.configuration)==null?void 0:u.uart),await U(t.connectPort,8192,c,36,(y=t.configuration)==null?void 0:y.uart))}else{let c=new Uint8Array(32);c.set(P(o.logo_line1,(h=t.configuration)==null?void 0:h.charset).subarray(0,16),0),c.set(P(o.logo_line2,(b=t.configuration)==null?void 0:b.charset).subarray(0,16),16),await U(t.connectPort,3760,c,32,(i=t.configuration)==null?void 0:i.uart)}await C(o.dtmfid,3808,8),await C(o.dtmf_up_code,3832,16),await C(o.dtmf_down_code,3848,16),(A=t.configuration)!=null&&A.localmdc&&await U(t.connectPort,8189,new Uint8Array([o.mdc_audio_local?1:0]),1,(S=t.configuration)==null?void 0:S.uart),await z(t.connectPort),$(!1)};return(e,l)=>{const s=R,n=G,_=H,d=J,f=M,w=O,p=x,u=Q,y=F,h=Y,b=q;return et(),at("div",lt,[a(s,{items:[e.$t("menu.dashboard"),e.$t("menu.cps.settings")]},null,8,["items"]),a(w,{gutter:20,align:"stretch"},{default:r(()=>[a(f,{span:24},{default:r(()=>[a(b,{class:"general-card",title:e.$t("menu.cps.settings")+e.$t("global.onStart")},{default:r(()=>[a(w,{style:{"margin-bottom":"16px"}},{default:r(()=>[a(f,{span:12},{default:r(()=>[a(d,null,{default:r(()=>[a(_,{type:"primary",onClick:K},{icon:r(()=>[a(n)]),default:r(()=>[B(" "+E(e.$t("cps.onDeviceRead")),1)]),_:1}),a(_,{onClick:L},{icon:r(()=>[a(n)]),default:r(()=>[B(" "+E(e.$t("cps.onDeviceWrite")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(h,{loading:nt(T),style:{width:"100%"}},{default:r(()=>[a(u,{"label-col-style":{width:"25%"},field:"logo_line1",label:e.$t("cps.line1")},{default:r(()=>[a(p,{modelValue:o.logo_line1,"onUpdate:modelValue":l[0]||(l[0]=i=>o.logo_line1=i)},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{"label-col-style":{width:"25%"},field:"logo_line2",label:e.$t("cps.line2")},{default:r(()=>[a(p,{modelValue:o.logo_line2,"onUpdate:modelValue":l[1]||(l[1]=i=>o.logo_line2=i)},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{"label-col-style":{width:"25%"},field:"dtmfid",label:e.$t("cps.dtmfid")},{default:r(()=>[a(p,{modelValue:o.dtmfid,"onUpdate:modelValue":l[2]||(l[2]=i=>o.dtmfid=i),"max-length":"8",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{"label-col-style":{width:"25%"},field:"dtmf_up_code",label:e.$t("cps.dtmf.up")},{default:r(()=>[a(p,{modelValue:o.dtmf_up_code,"onUpdate:modelValue":l[3]||(l[3]=i=>o.dtmf_up_code=i),"max-length":"16",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{"label-col-style":{width:"25%"},field:"dtmf_down_code",label:e.$t("cps.dtmf.down")},{default:r(()=>[a(p,{modelValue:o.dtmf_down_code,"onUpdate:modelValue":l[4]||(l[4]=i=>o.dtmf_down_code=i),"max-length":"16",placeholder:"0-9,A-D,*,#"},null,8,["modelValue"])]),_:1},8,["label"]),a(u,{"label-col-style":{width:"25%"},field:"mdclocplay",label:e.$t("cps.mdclocplay")},{default:r(()=>[a(y,{modelValue:o.mdc_audio_local,"onUpdate:modelValue":l[5]||(l[5]=i=>o.mdc_audio_local=i),type:"round"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["loading"])]),_:1},8,["title"])]),_:1})]),_:1})])}}});const Rt=j(rt,[["__scopeId","data-v-5076a5d5"]]);export{Rt as default};
